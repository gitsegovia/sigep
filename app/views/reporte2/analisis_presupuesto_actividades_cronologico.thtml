<?php
$_SESSION['entidad_federal_aux'] = $_SESSION["entidad_federal"];
$_SESSION['ejercicio'] = '';
$_SESSION['titulo'] = $_SESSION["dependencia"];
set_time_limit(0);
ini_set("memory_limit","1536M");
vendor('utf8_tcpdf/tcpdf');
/**********************************************************************/
$_SESSION["cod_sector"]       ="";
$_SESSION["deno_sector"]      ="";
$_SESSION["cod_programa"]     ="";
$_SESSION["deno_programa"]    ="";
$_SESSION["cod_sub_prog"]     ="";
$_SESSION["deno_sub_prog"]    ="";
$_SESSION["cod_proyecto"]     ="";
$_SESSION["deno_proyecto"]    ="";
$_SESSION["cod_activ_obra"]   ="";
$_SESSION["deno_activ_obra"]  ="";
$_SESSION["unidad_ejecutora"] ="";
$_SESSION["cod_partida"]      ="";
$_SESSION["cod_generica"]     ="";
$_SESSION["cod_especifica"]   ="";
$_SESSION["cod_sub_espec"]    ="";
$_SESSION["cod_auxiliar"]     ="";
$_SESSION["disponibilidadT"]  ="";
$_SESSION["denominacion"]     ="";
$_SESSION["asignacion_anual"] ="";
$_SESSION["aumento"]          ="";
$_SESSION["disminucion"]      ="";
$_SESSION["compromiso"]       ="";
$_SESSION["causado"]          ="";
$_SESSION["pagado"]           ="";

class fpdfview extends TCPDF{

    function setup ($orientation='Landscape',$unit='mm',$format='Letter') {
        $this->TCPDF($orientation, $unit, $format);
    }

    function fpdfOutput ($name = 'page.pdf', $destination = 's') {
        return $this->Output($name, $destination);
    }
/*
    function Footer(){

	    $this->SetY(-9);
		$this->SetFont('vera','',5);
	   	$this->Cell(0,7,'Página '.$this->PageNo().'/TPAG','',0,'C');
    }*/

    function Header(){


    	$this->top_reporte("ANÁLISIS RESUMIDO DEL PRESUPUESTO POR ACTIVIDADES ", null, null, array("Y"=>"5", "X"=>"16", "Z"=>"12"), array("Y"=>"17", "X"=>"255"));




		/*$this->Image('/var/www/sigep/app/webroot/img/escudo_base/escudo10.jpg',5,15,13);
		$this->SetFont('vera','B',9);
		$this->Cell(15,5,"",'TL',0);
		$this->Cell(120,5,$_SESSION['entidad_federal_aux']."",'T',0);
		$this->SetFont('vera','',7);
		$this->Cell(0,5,"FECHA: ".date("d/m/Y")."  ",'TR',1,'R');
		$this->Cell(15,3,"",'L',0);
		$this->SetFont('vera','',8);
		$this->Cell(0,3,$_SESSION['titulo']."",'R',1);

		$this->SetFont('vera','B',10);
		$this->Cell(0,9,"ANÁLISIS RESUMIDO DEL PRESUPUESTO POR ACTIVIDADES",'RLB',1,'C');
		$this->Ln(2);*/

		$this->SetFont('vera','B',6);
		$this->Cell(27,4,"",'TRL',0,'L');
		$this->Cell(15,4,"CÓDIGO",'TRL',0,'C');
		$this->Cell(0,4," DENOMINACIÓN",'TRL',1,'L');

		$this->Cell(27,4,"SECTOR",'TRL',0,'L');
		$this->SetFont('vera','',6);
		$this->Cell(15,4,$_SESSION["cod_sector"],'TRL',0,'C'); //-----[Codigo Sector]
		$this->Cell(0,4,$_SESSION["deno_sector"],'TRL',1,'L');  //-----[Denominacion]

		$this->SetFont('vera','B',6);
		$this->Cell(27,4,"PROGRAMA",'TRL',0,'L');
		$this->SetFont('vera','',6);
		$this->Cell(15,4,$_SESSION["cod_programa"],'TRL',0,'C'); //-----[Codigo Programa]
		$this->Cell(0,4,$_SESSION["deno_programa"],'TRL',1,'L');  //-----[Denominacion]

		$this->SetFont('vera','B',6);
		$this->Cell(27,4,"SUB-PROGRAMA",'TRL',0,'L');
		$this->SetFont('vera','',6);
		$this->Cell(15,4,$_SESSION["cod_sub_prog"],'TRL',0,'C'); //-----[Codigo Sub-Programa]
		$this->Cell(0,4,$_SESSION["deno_sub_prog"],'TRL',1,'L');  //-----[Denominacion]
        if($_SESSION["cod_proyecto"]!=0){
		$this->SetFont('vera','B',6);
		$this->Cell(27,4,"PROYECTO",'TRL',0,'L');
		$this->SetFont('vera','',6);
		$this->Cell(15,4,$_SESSION["cod_proyecto"],'TRL',0,'C');//-----[CÓDIGO PROYECTO]
		$this->Cell(0,4,$_SESSION["deno_proyecto"],'TRL',1,'L'); //-----[Denominacion]
        }
		$this->SetFont('vera','B',6);
		$this->Cell(27,4,"ACTIVIDAD U OBRA",'TRL',0,'L');
		$this->SetFont('vera','',6);
		$this->Cell(15,4,$_SESSION["cod_activ_obra"],'TRL',0,'C');//-----[CÓDIGO ACTIVIDAD U OBRA]
		$this->Cell(0,4,$_SESSION["deno_activ_obra"],'TRL',1,'L'); //-----[Denominacion]

		$this->SetFont('vera','B',6);
		$this->Cell(27,4,"UNIDAD EJECUTORA",'TBL',0,'L');
		$this->SetFont('vera','',6);
		$this->Cell(15,4,"",'TRB',0,'C');
		$this->Cell(0,4,$_SESSION["unidad_ejecutora"],'TRBL',1,'L'); //-----[Denominacion]


		$this->SetFont('vera','B',6);
		$this->Cell(6.5,4,"",'TL',0,'C');
		$this->Cell(6.5,4,"",'TL',0,'C');
		$this->Cell(6.5,4,"",'TL',0,'C');
		$this->Cell(6.5,4,"SUB.",'TL',0,'C');
		$this->Cell(7,4,"",'TL',0,'C');

		$this->Cell(46.5,4,"",'TL',0,'C');
		$this->Cell(20,4,"TIPO",'TL',0,'C');
		$this->Cell(13,4,"FECHA",'TL',0,'C');
		$this->Cell(20,4,"NÚMERO",'TL',0,'C');
		$this->Cell(20,4,"",'TL',0,'C');
		$this->Cell(20,4,"",'TL',0,'C');
		$this->Cell(20,4,"",'TL',0,'C');
		$this->Cell(20,4,"",'TL',0,'C');
		$this->Cell(20,4,"",'TL',0,'C');
		$this->Cell(20,4,"",'TL',0,'C');
		$this->Cell(0,4,"",'TRL',1,'C');

		//-------------------------------------------

		$this->Cell(6.5,4,"PAR.",'BL',0,'C');
		$this->Cell(6.5,4,"GEN.",'BL',0,'C');
		$this->Cell(6.5,4,"ESP.",'BL',0,'C');
		$this->Cell(6.5,4,"ESP.",'BL',0,'C');
		$this->Cell(7,4,"AUX.",'BRL',0,'C');
        $this->SetFont('vera','B',5);
		$this->Cell(46.5,4,"DENOMINACiÓN / Beneficiario",'BL',0,'C');
		$this->SetFont('vera','B',6);
		$this->Cell(20,4,"DOCUMENTO",'BL',0,'C');
		$this->Cell(13,4,"PROCESO",'BL',0,'C');
		$this->Cell(20,4,"DOCUMENTO",'BL',0,'C');
		$this->Cell(20,4,"ASIGNACIÓN",'BL',0,'C');
		$this->Cell(20,4,"AUMENTO",'BL',0,'C');
		$this->Cell(20,4,"DISMINUCIÓN",'BL',0,'C');
		$this->Cell(20,4,"COMPROMISO",'BL',0,'C');
		$this->Cell(20,4,"CAUSADO",'BL',0,'C');
		$this->Cell(20,4,"PAGADO",'BL',0,'C');
		$this->Cell(0,4,"DISPONIBILIDAD",'BRL',1,'C');

        $deno=trim($_SESSION["denominacion"]);
        $deno = preg_replace('/\s\s+/', ' ', trim($deno));
        $cdeno=strlen($deno);

        if($cdeno<=35){
            $alto="4";
        }else if($cdeno> 35 && $cdeno<=70){
        	$alto="6";
        }else if($cdeno> 70 && $cdeno<=105){
        	$alto="8";
        }else if($cdeno> 105 && $cdeno<=140){
        	$alto="10";
        }else if($cdeno> 140 && $cdeno<=175){
        	$alto="12";
        }else if($cdeno> 175 && $cdeno<=210){
        	$alto="14";
        }else if($cdeno> 210 && $cdeno<=245){
        	$alto="16";
        }else if($cdeno> 245 && $cdeno<=280){
        	$alto="18";
        }else if($cdeno> 280 && $cdeno<=315){
        	$alto="21";
        }else{
            $alto="26";
        }
		$this->SetFont('vera','B',6);
		$this->Cell(6.5,$alto,$_SESSION["cod_partida"],'TL',0,'C');//------[partida]
		$this->Cell(6.5,$alto,$_SESSION["cod_generica"],'TL',0,'C');//------[generica]
		$this->Cell(6.5,$alto,$_SESSION["cod_especifica"],'TL',0,'C');//------[especifica]
		$this->Cell(6.5,$alto,$_SESSION["cod_sub_espec"],'TL',0,'C');//------[sub-especifica]
		$this->Cell(7,$alto,$_SESSION["cod_auxiliar"],'TRL',0,'C');//-----[auxiliar]

		$this->SetFont('vera','',5);
		$this->Cell(46.5,1,"",'T',2,'C');//para hacer espacio
		    $varX = $this->GetX();
		    $varY = $this->GetY();
		    $this->MultiCell(46.5,2,$deno,'','L');//---[Beneficiario]
		    $varX = $varX+46.5;
		    $this->SetXY($varX,$varY-1);
		$this->SetFont('vera','',5);
		$this->Cell(20,$alto," ",'TL',0,'L');//--------[tipo Documento]
		$this->SetFont('vera','',6);
		$this->Cell(13,$alto," ",'TL',0,'C');//-----------[fecha Documento]
		$this->Cell(20,$alto," ",'TL',0,'C');//----------------[numero Documento]
		$this->Cell(20,$alto,$_SESSION["asignacion_anual"],'TL',0,'R');//-----------------[ASIGNACION]
		$this->Cell(20,$alto,$_SESSION["aumento"],'TL',0,'R');//----------------[AUMENTO]
		$this->Cell(20,$alto,$_SESSION["disminucion"],'TL',0,'R');//----------------[DISMINUCION]
		$this->Cell(20,$alto,$_SESSION["compromiso"],'TL',0,'R');//----------------[COMPROMISO]
		$this->Cell(20,$alto,$_SESSION["causado"],'TL',0,'R');//----------[CAUSADO]
		$this->Cell(20,$alto,$_SESSION["pagado"],'TL',0,'R');//----------[PAGADO]
		$this->Cell(0,$alto,$_SESSION["disponibilidadT"],'TRL',1,'R');//--------[DISPONIBILIDAD]
		$this->Cell(0,0,"",'T',1,'R');//--------[LINEA]

    }//fin funtion



    function imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$monto,$monto_disminucion,$monto_aumento,$monto_compromiso,$monto_causado,$monto_pagado,$titu='',$DISPONIBILIDAD) {
    	    if($tipo_docu==1){
    	    	$de_docu = 'Reformulación';
    	    	$monto_aumento     = $monto_aumento     == 0?'':$sisap->Formato2($monto_aumento);
	    	    $monto_disminucion = $monto_disminucion == 0?'':$sisap->Formato2($monto_disminucion);
	    	    $monto_compromiso  = '';
	    	    $monto_causado     = '';
	    	    $monto_pagado      = '';
	    	    $size_font_doc = strlen($numero_documento)>14?5:6;
    	    }else if($tipo_docu==2){
    	    	$de_docu = 'Compromisos';
    	    	$numero_documento = mascara($numero_documento,8);
    	    	$monto_aumento     = '';
	    	    $monto_disminucion = '';
	    	    $monto_compromiso  = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $monto_causado     = '';
	    	    $monto_pagado      = '';
	    	    $size_font_doc = 6;
    	    }else if($tipo_docu==3){
    	    	$de_docu = 'Orden de Compra';
    	    	$numero_documento = mascara($numero_documento,8);
    	    	$monto_aumento     = '';
	    	    $monto_disminucion = '';
	    	    $monto_compromiso  = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $monto_causado     = '';
	    	    $monto_pagado      = '';
	    	    $size_font_doc = 6;
    	    }else if($tipo_docu==4){
    	    	$de_docu = 'Contrato Obras';
    	    	$monto_aumento     = '';
	    	    $monto_disminucion = '';
	    	    $monto_compromiso  = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $monto_causado     = '';
	    	    $monto_pagado      = '';
	    	    $size_font_doc = strlen($numero_documento)>14?4.2:6;
    	    }else if($tipo_docu==5){
    	    	$de_docu = 'Contrato Servicio';
    	    	$monto_aumento     = '';
	    	    $monto_disminucion = '';
	    	    $monto_compromiso  = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $monto_causado     = '';
	    	    $monto_pagado      = '';
	    	    $size_font_doc = strlen($numero_documento)>14?4.2:6;
    	    }else if($tipo_docu==6){
    	    	$de_docu = 'Rendiciones';
    	    	$monto_aumento     = '';
	    	    $monto_disminucion = '';
	    	    $monto_compromiso  = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $monto_causado     = $monto     == 0?'':$sisap->Formato2($monto);
	    	    $monto_pagado      = $monto      == 0?'':$sisap->Formato2($monto);
	    	    $size_font_doc = 6;
    	    }else if($tipo_docu==7){
    	    	$de_docu = 'Nota de Debito';
    	    	$monto_aumento     = $monto_aumento     == 0?'':$sisap->Formato2($monto_aumento);
	    	    $monto_disminucion = $monto_disminucion == 0?'':$sisap->Formato2($monto_disminucion);
	    	    $monto_compromiso  = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $monto_causado     = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $monto_pagado      = $monto  == 0?'':$sisap->Formato2($monto);
	    	    $size_font_doc = 6;
    	    }else if($tipo_docu==8){
    	    	$de_docu = 'Reintegro';
    	    	$monto_aumento     = '';
	    	    $monto_disminucion = '';
	    	    $monto_compromiso  = $monto_compromiso  == 0?'':$sisap->Formato2($monto_compromiso);
	    	    $monto_causado     = $monto_causado     == 0?'':$sisap->Formato2($monto_causado);
	    	    $monto_pagado      = $monto_pagado      == 0?'':$sisap->Formato2($monto_pagado);
	    	    $size_font_doc = 6;
    	    }else if($tipo_docu==0){
    	    	$de_docu = $titu;
    	    	$numero_documento = mascara($numero_documento,8);
    	    	$monto_aumento     = '';
	    	    $monto_disminucion = '';
	    	    $monto_compromiso  = $monto_compromiso  == 0?'':$sisap->Formato2($monto_compromiso);
	    	    $monto_causado     = $monto_causado     == 0?'':$sisap->Formato2($monto_causado);
	    	    $monto_pagado      = $monto_pagado      == 0?'':$sisap->Formato2($monto_pagado);
	    	    $size_font_doc = 6;
    	    }

            $cBen=strlen($de_docu);
			if($cBen>35){
				$alto=6;
			}else{
				$alto=5;
			}
	        $this->SetFont('vera','B',6);
			$this->Cell(6.5,$alto,"",'L',0,'C');//------[partida]
			$this->Cell(6.5,$alto,"",'L',0,'C');//------[generica]
			$this->Cell(6.5,$alto,"",'L',0,'C');//------[especifica]
			$this->Cell(6.5,$alto,"",'L',0,'C');//------[sub-especifica]
			$this->Cell(7,$alto,"",'RL',0,'C');//-----[auxiliar]
			$this->SetFont('vera','',6);
			$this->Cell(46.5,1,"",'T',2,'C');//para hacer espacio
			$varX = $this->GetX();
			$varY = $this->GetY();
			$this->SetFont('vera','',5);
			$this->MultiCell(46.5,2,$beneficiario,'','L');//---[Beneficiario]
			$varX = $varX+46.5;
			$this->SetXY($varX,$varY-1);
			$this->SetFont('vera','',5);
			$this->Cell(20,$alto,$de_docu,'L',0,'L');//--------[tipo Documento]
			$this->SetFont('vera','',6);
			$this->Cell(13,$alto,cambiar_formato_fecha($fecha_documento),'L',0,'C');//-----------[fecha Documento]
			$this->SetFont('vera','',$size_font_doc);
			$this->Cell(20,$alto,$numero_documento,'L',0,'C');//----------------[numero Documento]
			$this->SetFont('vera','',6);
			$this->Cell(20,$alto," ",'L',0,'R');//-----------------[ASIGNACION]
			$this->Cell(20,$alto,$monto_aumento,'L',0,'R');//----------------[AUMENTO]
			$this->Cell(20,$alto,$monto_disminucion,'L',0,'R');//----------------[DISMINUCION]
			$this->Cell(20,$alto,$monto_compromiso,'L',0,'R');//----------------[COMPROMISO]
			$this->Cell(20,$alto,$monto_causado,'L',0,'R');//----------[CAUSADO]
			$this->Cell(20,$alto,$monto_pagado,'L',0,'R');//----------[PAGADO]
			$this->Cell(0,$alto,$sisap->Formato2($DISPONIBILIDAD),'RL',1,'R');//--------[DISPONIBILIDAD]
	        $this->Cell(0,0,"",'T',1,'R');//--------[LINEA]

	}//fin funcion imprimir_fila_documento


}//fin clase


$fpdf = new fpdfview('L','mm','Letter');
$fpdf->AliasNbPages('TPAG');
$fpdf->SetTopMargin(15);
$fpdf->SetLeftMArgin(3);
$fpdf->SetRightMargin(3);
$fpdf->SetAutoPageBreak(true, 7);

/*
* Todo esto de aqui para abajo es el cuerpo del reporte Jose Gregorio.
*/
if(isset($DATOS) && $DATOS!=null){
foreach($DATOS as $key_index_datos=>$datos){
	$dato=$datos["v_analisis_presupuesto"];
	//print_r($dato);
	$_SESSION["cod_sector"]       = $sisap->AddCero3($dato["cod_sector"]);
	$_SESSION["deno_sector"]      = $dato["deno_sector"];
	$_SESSION["cod_programa"]     = $sisap->AddCero3($dato["cod_programa"]);
	$_SESSION["deno_programa"]    = $dato["deno_programa"];
	$_SESSION["cod_sub_prog"]     = $sisap->AddCero3($dato["cod_sub_prog"]);
	$_SESSION["deno_sub_prog"]    = $dato["deno_sub_prog"];
	$_SESSION["cod_proyecto"]     = $sisap->AddCero3($dato["cod_proyecto"]);
	$_SESSION["deno_proyecto"]    = $dato["deno_proyecto"];
	$_SESSION["cod_activ_obra"]   = $sisap->AddCero3($dato["cod_activ_obra"]);
	$_SESSION["deno_activ_obra"]  = $dato["deno_activ_obra"];
	$_SESSION["unidad_ejecutora"] = $dato["unidad_e_actividad"];
	$_SESSION["cod_partida"]      = $dato["cod_partida"];
	$_SESSION["cod_generica"]     = $sisap->AddCero3($dato["cod_generica"]);
	$_SESSION["cod_especifica"]   = $sisap->AddCero3($dato["cod_especifica"]);
	$_SESSION["cod_sub_espec"]    = $sisap->AddCero3($dato["cod_sub_espec"]);
	$_SESSION["cod_auxiliar"]     = $sisap->mascara_cuatro($dato["cod_auxiliar"]);
	if($dato["cod_auxiliar"]==0){
		$_SESSION["denominacion"]  =$dato["deno_sub_espec"];
	}else{
	    $_SESSION["denominacion"]  =$dato["deno_auxiliar"];
	}
	$_SESSION["disponibilidadT"]  =$dato["disponibilidad"];
	$_SESSION["asignacion_anual"] =$sisap->Formato2($dato["asignacion_anual"]);
	$_SESSION["aumento"]          =$sisap->Formato2($dato["aumento"]);
	$_SESSION["disminucion"]      =$sisap->Formato2($dato["disminucion"]);
	$_SESSION["compromiso"]       =$sisap->Formato2($dato["compromiso_anual"]);
	$_SESSION["causado"]          =$sisap->Formato2($dato["causado_anual"]);
	$_SESSION["pagado"]           =$sisap->Formato2($dato["pagado_anual"]);
	$DISPONIBILIDAD=$dato["asignacion_anual"]+$dato["aumento"]-$dato["disminucion"];
	$_SESSION["disponibilidadT"]  =$sisap->Formato2($DISPONIBILIDAD);
	$fpdf->AddPage();
	//foreach de reformulacion
	//###########################
	$t_aumento=0;
	$t_disminucion=0;
	$DISPONIBILIDAD=$dato["asignacion_anual"];
    $t_compromiso=0;
	$t_orden_pago=0;
	$t_cheques=0;
	//pr($CRONOLOGICO);
    foreach($CRONOLOGICO as $key_index=>$crono){
    	if($crono[0]["tipo_documento_reporte"]!=1){
    		$crono[0]["codi_dep"] = $crono[0]["cod_dep"];
    	}
        if($dato["cod_presi"]==$crono[0]["cod_presi"] && $dato["cod_entidad"]==$crono[0]["cod_entidad"] && $dato["cod_tipo_inst"]==$crono[0]["cod_tipo_inst"] && $dato["cod_inst"]==$crono[0]["cod_inst"] && $dato["cod_dep"]==$crono[0]["codi_dep"] && $dato["cod_sector"]==$crono[0]["cod_sector"] && $dato["cod_programa"]==$crono[0]["cod_programa"] && $dato["cod_sub_prog"]==$crono[0]["cod_sub_prog"] && $dato["cod_proyecto"]==$crono[0]["cod_proyecto"] && $dato["cod_activ_obra"]==$crono[0]["cod_activ_obra"] && $dato["cod_partida"]==$crono[0]["cod_partida"] && $dato["cod_generica"]==$crono[0]["cod_generica"] && $dato["cod_especifica"]==$crono[0]["cod_especifica"] && $dato["cod_sub_espec"]==$crono[0]["cod_sub_espec"] && $dato["cod_auxiliar"]==$crono[0]["cod_auxiliar"]){
    	    $tipo_docu = $crono[0]["tipo_documento_reporte"];
    	    $numero_documento = $crono[0]["numero_documento"];
    	    $fecha_documento = $crono[0]["fecha_documento"];
    	    $beneficiario = $crono[0]["beneficiario"];
    	    $tipo_docu = $crono[0]["tipo_documento_reporte"];
    	    $pmonto_aumento     = $crono[0]["monto_aumento"];
    	    $pmonto_disminucion = $crono[0]["monto_disminucion"];
    	    $pmonto_compromiso  = $crono[0]["monto_compromiso"];
    	    $pmonto_causado     = $crono[0]["monto_causado"];
    	    $pmonto_pagado      = $crono[0]["monto_pagado"];
    	    $pmonto             = $crono[0]["monto"];
    	   if($tipo_docu==1){
    	    	$de_docu = 'Reformulación';
	    	    $DISPONIBILIDAD=$DISPONIBILIDAD+$crono[0]["monto_aumento"]-$crono[0]["monto_disminucion"];
	    	    $t_aumento=$t_aumento+$crono[0]["monto_aumento"];
	            $t_disminucion=$t_disminucion+$crono[0]["monto_disminucion"];
	            $numero_documento = $crono[0]["numero_decreto"];
	            $fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);
    	    }else if($tipo_docu==2){
    	    	$de_docu = 'Compromisos';
	    	    $DISPONIBILIDAD=$DISPONIBILIDAD-$crono[0]["monto"];
	    	    $t_compromiso=$t_compromiso+$crono[0]["monto"];
	    	    $fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);
			     foreach($orden_pago as $key_index_OP=>$OP){
	               if($crono[0]["cod_presi"]==$OP[0]["cod_presi"] && $crono[0]["cod_entidad"]==$OP[0]["cod_entidad"] && $crono[0]["cod_tipo_inst"]==$OP[0]["cod_tipo_inst"] && $crono[0]["cod_inst"]==$OP[0]["cod_inst"] && $crono[0]["cod_dep"]==$OP[0]["cod_dep"] && $crono[0]["cod_sector"]==$OP[0]["cod_sector"] && $crono[0]["cod_programa"]==$OP[0]["cod_programa"] && $crono[0]["cod_sub_prog"]==$OP[0]["cod_sub_prog"] && $crono[0]["cod_proyecto"]==$OP[0]["cod_proyecto"] && $crono[0]["cod_activ_obra"]==$OP[0]["cod_activ_obra"] && $crono[0]["cod_partida"]==$OP[0]["cod_partida"] && $crono[0]["cod_generica"]==$OP[0]["cod_generica"] && $crono[0]["cod_especifica"]==$OP[0]["cod_especifica"] && $crono[0]["cod_sub_espec"]==$OP[0]["cod_sub_espec"] && $crono[0]["cod_auxiliar"]==$OP[0]["cod_auxiliar"] && $crono[0]["numero_orden_pago"]==$OP[0]["numero_orden_pago"]  && $crono[0]["numero_documento"]==$OP[0]["numero_documento_origen"]  && $OP[0]["numero_documento_adjunto"]=="0"  && $crono[0]["ano_orden_pago"]==$OP[0]["ano_orden_pago"]){
						$fpdf->imprimir_fila_documento ($sisap,$OP[0]["numero_orden_pago"],$OP[0]["fecha_orden_pago"],0,'',0,0,0,0,$OP[0]["monto"],0,'Orden de Pago',0);
						$t_orden_pago=$t_orden_pago+$OP[0]["monto"];
	                        foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"] && $OP[0]["numero_orden_pago_secuencia"]==$CH[0]["numero_orden_pago_secuencia"] && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]){
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,'',0,0,0,0,0,$CH[0]["monto"],'Cheque',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques

							foreach($NOTADEBITO as $NDD){
									if($OP[0]["cod_presi"]==$NDD[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD[0]["numero_documento"],$NDD[0]["fecha_nota_debito"],0,'',0,0,0,0,0,$NDD[0]["monto"],'Nota de Debito E.',0);
										$t_cheques=$t_cheques+$NDD[0]["monto"];
									}//fin if
							}//Nota de debitos

	                        foreach($NOTADEBITO_CA as $NDD_CA){
									if($OP[0]["cod_presi"]==$NDD_CA[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD_CA[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD_CA[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD_CA[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD_CA[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD_CA[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD_CA[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD_CA[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD_CA[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD_CA[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD_CA[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD_CA[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD_CA[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD_CA[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD_CA[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD_CA[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD_CA[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD_CA[0]["numero_debito"],$NDD_CA[0]["fecha_debito"],0,'',0,0,0,0,0,$NDD_CA[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$NDD_CA[0]["monto"];
									}//fin if
							}//Nota de debitos cancelaciones

							foreach($DEBITO as $DEB){
									if($OP[0]["cod_presi"]==$DEB[0]["cod_presi"] && $OP[0]["cod_entidad"]==$DEB[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$DEB[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$DEB[0]["cod_inst"] && $OP[0]["cod_dep"]==$DEB[0]["cod_dep"] && $OP[0]["cod_sector"]==$DEB[0]["cod_sector"] && $OP[0]["cod_programa"]==$DEB[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$DEB[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$DEB[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$DEB[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$DEB[0]["cod_partida"] && $OP[0]["cod_generica"]==$DEB[0]["cod_generica"] && $OP[0]["cod_especifica"]==$DEB[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$DEB[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$DEB[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$DEB[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$DEB[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$DEB[0]["numero_debito"],$DEB[0]["fecha_debito"],0,'',0,0,0,0,0,$DEB[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$DEB[0]["monto"];
									}//fin if
							}//debito

	                        //Clase de beneficiario
							//1.- Beneficiario común
							//2.- I.S.L.R.
							//3.- Timbre fiscal
							//4.- Impuesto Municipal
							//5.- I.V.A.
							//RETENCION IVA
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==5){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención iva',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion iva

							//RETENCION ISLR
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==2){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención islr',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion islr

							//RETENCION MUNICIPAL
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==4){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención municipal',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion municipal

							//RETENCION TIMBRE
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==3){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención timbre',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion timbre
							array_splice($orden_pago,$key_index_OP,1);
	             }//fin if
				}//fin foreach



    	    }else if($tipo_docu==3){
    	    	$de_docu = 'Orden de Compra';
    	    	$DISPONIBILIDAD=$DISPONIBILIDAD-$crono[0]["monto"];
    	    	$t_compromiso=$t_compromiso+$crono[0]["monto"];

    	    	$fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);

			    foreach($OCMcompromisos as $OCM){
					if($crono[0]["cod_presi"]==$OCM[0]["cod_presi"] && $crono[0]["cod_entidad"]==$OCM[0]["cod_entidad"] && $crono[0]["cod_tipo_inst"]==$OCM[0]["cod_tipo_inst"] && $crono[0]["cod_inst"]==$OCM[0]["cod_inst"] && $crono[0]["cod_dep"]==$OCM[0]["cod_dep"] && $crono[0]["cod_sector"]==$OCM[0]["cod_sector"] && $crono[0]["cod_programa"]==$OCM[0]["cod_programa"] && $crono[0]["cod_sub_prog"]==$OCM[0]["cod_sub_prog"] && $crono[0]["cod_proyecto"]==$OCM[0]["cod_proyecto"] && $crono[0]["cod_activ_obra"]==$OCM[0]["cod_activ_obra"] && $crono[0]["cod_partida"]==$OCM[0]["cod_partida"] && $crono[0]["cod_generica"]==$OCM[0]["cod_generica"] && $crono[0]["cod_especifica"]==$OCM[0]["cod_especifica"] && $crono[0]["cod_sub_espec"]==$OCM[0]["cod_sub_espec"] && $crono[0]["cod_auxiliar"]==$OCM[0]["cod_auxiliar"] && $crono[0]["numero_documento"]==$OCM[0]["numero_orden_compra"]){
						if($OCM[0]["tipo_modificacion"]==1){//aumento
							$DISPONIBILIDAD=$DISPONIBILIDAD-$OCM[0]["monto"];
							$t_compromiso=$t_compromiso+$OCM[0]["monto"];
			            }else {//disminucion
			            	$DISPONIBILIDAD=$DISPONIBILIDAD+$OCM[0]["monto"];
							$t_compromiso=$t_compromiso-$OCM[0]["monto"];
			            }
						$fpdf->imprimir_fila_documento ($sisap,$OCM[0]["numero_modificacion"],$OCM[0]["fecha_modificacion"],0,'',0,0,0,$OCM[0]["monto"],0,0,'Modif. O.Compra',$DISPONIBILIDAD);
					 }
				}//fin orden de compra modificaciones

			    foreach($orden_pago as $OP){
	               if($crono[0]["ano"]==$OP[0]["ano"] && $crono[0]["cod_presi"]==$OP[0]["cod_presi"] && $crono[0]["cod_entidad"]==$OP[0]["cod_entidad"] && $crono[0]["cod_tipo_inst"]==$OP[0]["cod_tipo_inst"] && $crono[0]["cod_inst"]==$OP[0]["cod_inst"] && $crono[0]["cod_dep"]==$OP[0]["cod_dep"] && $crono[0]["cod_sector"]==$OP[0]["cod_sector"] && $crono[0]["cod_programa"]==$OP[0]["cod_programa"] && $crono[0]["cod_sub_prog"]==$OP[0]["cod_sub_prog"] && $crono[0]["cod_proyecto"]==$OP[0]["cod_proyecto"] && $crono[0]["cod_activ_obra"]==$OP[0]["cod_activ_obra"] && $crono[0]["cod_partida"]==$OP[0]["cod_partida"] && $crono[0]["cod_generica"]==$OP[0]["cod_generica"] && $crono[0]["cod_especifica"]==$OP[0]["cod_especifica"] && $crono[0]["cod_sub_espec"]==$OP[0]["cod_sub_espec"] && $crono[0]["cod_auxiliar"]==$OP[0]["cod_auxiliar"] && $crono[0]["numero_documento"]==$OP[0]["numero_documento_origen"]  && $OP[0]["numero_documento_adjunto"]!="0"){
						$fpdf->imprimir_fila_documento ($sisap,$OP[0]["numero_orden_pago"],$OP[0]["fecha_orden_pago"],0,'',0,0,0,0,$OP[0]["monto"],0,'Orden de Pago',0);
						$t_orden_pago=$t_orden_pago+$OP[0]["monto"];
	                        foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]){
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,'',0,0,0,0,0,$CH[0]["monto"],'Cheque',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques

							foreach($NOTADEBITO as $NDD){
									if($OP[0]["cod_presi"]==$NDD[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD[0]["numero_documento"],$NDD[0]["fecha_nota_debito"],0,'',0,0,0,0,0,$NDD[0]["monto"],'Nota de Debito E.',0);
										$t_cheques=$t_cheques+$NDD[0]["monto"];
									}//fin if
							}//Nota de debitos

	                        foreach($NOTADEBITO_CA as $NDD_CA){
									if($OP[0]["cod_presi"]==$NDD_CA[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD_CA[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD_CA[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD_CA[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD_CA[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD_CA[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD_CA[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD_CA[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD_CA[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD_CA[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD_CA[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD_CA[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD_CA[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD_CA[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD_CA[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD_CA[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD_CA[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD_CA[0]["numero_debito"],$NDD_CA[0]["fecha_debito"],0,'',0,0,0,0,0,$NDD_CA[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$NDD_CA[0]["monto"];
									}//fin if
							}//Nota de debitos cancelaciones

							foreach($DEBITO as $DEB){
									if($OP[0]["cod_presi"]==$DEB[0]["cod_presi"] && $OP[0]["cod_entidad"]==$DEB[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$DEB[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$DEB[0]["cod_inst"] && $OP[0]["cod_dep"]==$DEB[0]["cod_dep"] && $OP[0]["cod_sector"]==$DEB[0]["cod_sector"] && $OP[0]["cod_programa"]==$DEB[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$DEB[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$DEB[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$DEB[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$DEB[0]["cod_partida"] && $OP[0]["cod_generica"]==$DEB[0]["cod_generica"] && $OP[0]["cod_especifica"]==$DEB[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$DEB[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$DEB[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$DEB[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$DEB[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$DEB[0]["numero_debito"],$DEB[0]["fecha_debito"],0,'',0,0,0,0,0,$DEB[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$DEB[0]["monto"];
									}//fin if
							}//debito

	                        //Clase de beneficiario
							//1.- Beneficiario común
							//2.- I.S.L.R.
							//3.- Timbre fiscal
							//4.- Impuesto Municipal
							//5.- I.V.A.
							//RETENCION IVA
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==5){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención iva',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion iva

							//RETENCION ISLR
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==2){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención islr',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion islr

							//RETENCION MUNICIPAL
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==4){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención municipal',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion municipal

							//RETENCION TIMBRE
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==3){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención timbre',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion timbre
	             }//fin if
				}//fin foreach

    	    }else if($tipo_docu==4){
    	    	$de_docu = 'Contrato Obras';
    	    	$DISPONIBILIDAD=$DISPONIBILIDAD-$crono[0]["monto"];
    	    	$t_compromiso=$t_compromiso+$crono[0]["monto"];

    	    	$fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);
			    foreach($OBMcompromisos as $key_index_OCM=>$OCM){
					if($crono[0]["cod_presi"]==$OCM[0]["cod_presi"] && $crono[0]["cod_entidad"]==$OCM[0]["cod_entidad"] && $crono[0]["cod_tipo_inst"]==$OCM[0]["cod_tipo_inst"] && $crono[0]["cod_inst"]==$OCM[0]["cod_inst"] && $crono[0]["cod_dep"]==$OCM[0]["cod_dep"] && $crono[0]["cod_sector"]==$OCM[0]["cod_sector"] && $crono[0]["cod_programa"]==$OCM[0]["cod_programa"] && $crono[0]["cod_sub_prog"]==$OCM[0]["cod_sub_prog"] && $crono[0]["cod_proyecto"]==$OCM[0]["cod_proyecto"] && $crono[0]["cod_activ_obra"]==$OCM[0]["cod_activ_obra"] && $crono[0]["cod_partida"]==$OCM[0]["cod_partida"] && $crono[0]["cod_generica"]==$OCM[0]["cod_generica"] && $crono[0]["cod_especifica"]==$OCM[0]["cod_especifica"] && $crono[0]["cod_sub_espec"]==$OCM[0]["cod_sub_espec"] && $crono[0]["cod_auxiliar"]==$OCM[0]["cod_auxiliar"] && $crono[0]["numero_documento"]==$OCM[0]["numero_contrato_obra"]){
						if($OCM[0]["tipo_modificacion"]==1){//aumento
							$DISPONIBILIDAD=$DISPONIBILIDAD-$OCM[0]["monto"];
							$t_compromiso=$t_compromiso+$OCM[0]["monto"];
			            }else {//disminucion
			            	$DISPONIBILIDAD=$DISPONIBILIDAD+$OCM[0]["monto"];
							$t_compromiso=$t_compromiso-$OCM[0]["monto"];
			            }
						$fpdf->imprimir_fila_documento ($sisap,$OCM[0]["numero_modificacion"],$OCM[0]["fecha_modificacion"],0,'',0,0,0,$OCM[0]["monto"],0,0,'Modif. C.Obras',$DISPONIBILIDAD);
					  array_splice($OBMcompromisos,$key_index_OCM,1);
					 }
				}//fin orden de compra modificaciones

			    foreach($orden_pago as $key_index_OP=>$OP){
	               if($crono[0]["cod_presi"]==$OP[0]["cod_presi"] && $crono[0]["cod_entidad"]==$OP[0]["cod_entidad"] && $crono[0]["cod_tipo_inst"]==$OP[0]["cod_tipo_inst"] && $crono[0]["cod_inst"]==$OP[0]["cod_inst"] && $crono[0]["cod_dep"]==$OP[0]["cod_dep"] && $crono[0]["cod_sector"]==$OP[0]["cod_sector"] && $crono[0]["cod_programa"]==$OP[0]["cod_programa"] && $crono[0]["cod_sub_prog"]==$OP[0]["cod_sub_prog"] && $crono[0]["cod_proyecto"]==$OP[0]["cod_proyecto"] && $crono[0]["cod_activ_obra"]==$OP[0]["cod_activ_obra"] && $crono[0]["cod_partida"]==$OP[0]["cod_partida"] && $crono[0]["cod_generica"]==$OP[0]["cod_generica"] && $crono[0]["cod_especifica"]==$OP[0]["cod_especifica"] && $crono[0]["cod_sub_espec"]==$OP[0]["cod_sub_espec"] && $crono[0]["cod_auxiliar"]==$OP[0]["cod_auxiliar"]  && $crono[0]["numero_documento"]==$OP[0]["numero_documento_origen"]  && $OP[0]["numero_documento_adjunto"]!="0"  && $crono[0]["ano_orden_pago"]==$OP[0]["ano_orden_pago"]){
						$fpdf->imprimir_fila_documento ($sisap,$OP[0]["numero_orden_pago"],$OP[0]["fecha_orden_pago"],0,'',0,0,0,0,$OP[0]["monto"],0,'Orden de Pago',0);
						$t_orden_pago=$t_orden_pago+$OP[0]["monto"];
	                        foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]){
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,'',0,0,0,0,0,$CH[0]["monto"],'Cheque',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques

							foreach($NOTADEBITO as $NDD){
									if($OP[0]["cod_presi"]==$NDD[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD[0]["numero_documento"],$NDD[0]["fecha_nota_debito"],0,'',0,0,0,0,0,$NDD[0]["monto"],'Nota de Debito E.',0);
										$t_cheques=$t_cheques+$NDD[0]["monto"];
									}//fin if
							}//Nota de debitos

	                        foreach($NOTADEBITO_CA as $NDD_CA){
									if($OP[0]["cod_presi"]==$NDD_CA[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD_CA[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD_CA[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD_CA[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD_CA[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD_CA[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD_CA[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD_CA[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD_CA[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD_CA[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD_CA[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD_CA[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD_CA[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD_CA[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD_CA[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD_CA[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD_CA[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD_CA[0]["numero_debito"],$NDD_CA[0]["fecha_debito"],0,'',0,0,0,0,0,$NDD_CA[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$NDD_CA[0]["monto"];
									}//fin if
							}//Nota de debitos cancelaciones

							foreach($DEBITO as $DEB){
									if($OP[0]["cod_presi"]==$DEB[0]["cod_presi"] && $OP[0]["cod_entidad"]==$DEB[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$DEB[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$DEB[0]["cod_inst"] && $OP[0]["cod_dep"]==$DEB[0]["cod_dep"] && $OP[0]["cod_sector"]==$DEB[0]["cod_sector"] && $OP[0]["cod_programa"]==$DEB[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$DEB[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$DEB[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$DEB[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$DEB[0]["cod_partida"] && $OP[0]["cod_generica"]==$DEB[0]["cod_generica"] && $OP[0]["cod_especifica"]==$DEB[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$DEB[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$DEB[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$DEB[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$DEB[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$DEB[0]["numero_debito"],$DEB[0]["fecha_debito"],0,'',0,0,0,0,0,$DEB[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$DEB[0]["monto"];
									}//fin if
							}//debito

	                        //Clase de beneficiario
							//1.- Beneficiario común
							//2.- I.S.L.R.
							//3.- Timbre fiscal
							//4.- Impuesto Municipal
							//5.- I.V.A.
							//RETENCION IVA
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==5){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención iva',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion iva

							//RETENCION ISLR
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==2){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención islr',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion islr

							//RETENCION MUNICIPAL
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==4){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención municipal',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion municipal

							//RETENCION TIMBRE
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==3){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención timbre',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion timbre
							array_splice($orden_pago,$key_index_OP,1);
	             }//fin if
				}//fin foreach



    	    }else if($tipo_docu==5){
    	    	$de_docu = 'Contrato Servicio';
    	    	$DISPONIBILIDAD=$DISPONIBILIDAD-$crono[0]["monto"];
    	    	$t_compromiso=$t_compromiso+$crono[0]["monto"];

    	    	$fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);
			    foreach($CSMcompromisos as $OCM){
					if($crono[0]["cod_presi"]==$OCM[0]["cod_presi"] && $crono[0]["cod_entidad"]==$OCM[0]["cod_entidad"] && $crono[0]["cod_tipo_inst"]==$OCM[0]["cod_tipo_inst"] && $crono[0]["cod_inst"]==$OCM[0]["cod_inst"] && $crono[0]["cod_dep"]==$OCM[0]["cod_dep"] && $crono[0]["cod_sector"]==$OCM[0]["cod_sector"] && $crono[0]["cod_programa"]==$OCM[0]["cod_programa"] && $crono[0]["cod_sub_prog"]==$OCM[0]["cod_sub_prog"] && $crono[0]["cod_proyecto"]==$OCM[0]["cod_proyecto"] && $crono[0]["cod_activ_obra"]==$OCM[0]["cod_activ_obra"] && $crono[0]["cod_partida"]==$OCM[0]["cod_partida"] && $crono[0]["cod_generica"]==$OCM[0]["cod_generica"] && $crono[0]["cod_especifica"]==$OCM[0]["cod_especifica"] && $crono[0]["cod_sub_espec"]==$OCM[0]["cod_sub_espec"] && $crono[0]["cod_auxiliar"]==$OCM[0]["cod_auxiliar"] && $crono[0]["numero_documento"]==$OCM[0]["numero_contrato_servicio"]){
						if($OCM[0]["tipo_modificacion"]==1){//aumento
							$DISPONIBILIDAD=$DISPONIBILIDAD-$OCM[0]["monto"];
							$t_compromiso=$t_compromiso+$OCM[0]["monto"];
			            }else {//disminucion
			            	$DISPONIBILIDAD=$DISPONIBILIDAD+$OCM[0]["monto"];
							$t_compromiso=$t_compromiso-$OCM[0]["monto"];
			            }
						$fpdf->imprimir_fila_documento ($sisap,$OCM[0]["numero_modificacion"],$OCM[0]["fecha_modificacion"],0,'',0,0,0,$OCM[0]["monto"],0,0,'Modif. C. Serv.',$DISPONIBILIDAD);
					 }
				}//fin orden de compra modificaciones

			    foreach($orden_pago as $OP){
	               if($crono[0]["cod_presi"]==$OP[0]["cod_presi"] && $crono[0]["cod_entidad"]==$OP[0]["cod_entidad"] && $crono[0]["cod_tipo_inst"]==$OP[0]["cod_tipo_inst"] && $crono[0]["cod_inst"]==$OP[0]["cod_inst"] && $crono[0]["cod_dep"]==$OP[0]["cod_dep"] && $crono[0]["cod_sector"]==$OP[0]["cod_sector"] && $crono[0]["cod_programa"]==$OP[0]["cod_programa"] && $crono[0]["cod_sub_prog"]==$OP[0]["cod_sub_prog"] && $crono[0]["cod_proyecto"]==$OP[0]["cod_proyecto"] && $crono[0]["cod_activ_obra"]==$OP[0]["cod_activ_obra"] && $crono[0]["cod_partida"]==$OP[0]["cod_partida"] && $crono[0]["cod_generica"]==$OP[0]["cod_generica"] && $crono[0]["cod_especifica"]==$OP[0]["cod_especifica"] && $crono[0]["cod_sub_espec"]==$OP[0]["cod_sub_espec"] && $crono[0]["cod_auxiliar"]==$OP[0]["cod_auxiliar"]  && $crono[0]["numero_documento"]==$OP[0]["numero_documento_origen"]  && $OP[0]["numero_documento_adjunto"]!="0"){
						$fpdf->imprimir_fila_documento ($sisap,$OP[0]["numero_orden_pago"],$OP[0]["fecha_orden_pago"],0,'',0,0,0,0,$OP[0]["monto"],0,'Orden de Pago',0);
						$t_orden_pago=$t_orden_pago+$OP[0]["monto"];
	                        foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]){
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,'',0,0,0,0,0,$CH[0]["monto"],'Cheque',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques

							foreach($NOTADEBITO as $NDD){
									if($OP[0]["cod_presi"]==$NDD[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD[0]["numero_documento"],$NDD[0]["fecha_nota_debito"],0,'',0,0,0,0,0,$NDD[0]["monto"],'Nota de Debito E.',0);
										$t_cheques=$t_cheques+$NDD[0]["monto"];
									}//fin if
							}//Nota de debitos

	                        foreach($NOTADEBITO_CA as $NDD_CA){
									if($OP[0]["cod_presi"]==$NDD_CA[0]["cod_presi"] && $OP[0]["cod_entidad"]==$NDD_CA[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$NDD_CA[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$NDD_CA[0]["cod_inst"] && $OP[0]["cod_dep"]==$NDD_CA[0]["cod_dep"] && $OP[0]["cod_sector"]==$NDD_CA[0]["cod_sector"] && $OP[0]["cod_programa"]==$NDD_CA[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$NDD_CA[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$NDD_CA[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$NDD_CA[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$NDD_CA[0]["cod_partida"] && $OP[0]["cod_generica"]==$NDD_CA[0]["cod_generica"] && $OP[0]["cod_especifica"]==$NDD_CA[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$NDD_CA[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$NDD_CA[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$NDD_CA[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$NDD_CA[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$NDD_CA[0]["numero_debito"],$NDD_CA[0]["fecha_debito"],0,'',0,0,0,0,0,$NDD_CA[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$NDD_CA[0]["monto"];
									}//fin if
							}//Nota de debitos cancelaciones

							foreach($DEBITO as $DEB){
									if($OP[0]["cod_presi"]==$DEB[0]["cod_presi"] && $OP[0]["cod_entidad"]==$DEB[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$DEB[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$DEB[0]["cod_inst"] && $OP[0]["cod_dep"]==$DEB[0]["cod_dep"] && $OP[0]["cod_sector"]==$DEB[0]["cod_sector"] && $OP[0]["cod_programa"]==$DEB[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$DEB[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$DEB[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$DEB[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$DEB[0]["cod_partida"] && $OP[0]["cod_generica"]==$DEB[0]["cod_generica"] && $OP[0]["cod_especifica"]==$DEB[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$DEB[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$DEB[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$DEB[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$DEB[0]["ano_orden_pago"]){
										$fpdf->imprimir_fila_documento ($sisap,$DEB[0]["numero_debito"],$DEB[0]["fecha_debito"],0,'',0,0,0,0,0,$DEB[0]["monto"],'Nota de Debito',0);
										$t_cheques=$t_cheques+$DEB[0]["monto"];
									}//fin if
							}//debito

	                        //Clase de beneficiario
							//1.- Beneficiario común
							//2.- I.S.L.R.
							//3.- Timbre fiscal
							//4.- Impuesto Municipal
							//5.- I.V.A.
							//RETENCION IVA
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==5){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención iva',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion iva

							//RETENCION ISLR
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==2){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención islr',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion islr

							//RETENCION MUNICIPAL
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==4){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención municipal',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion municipal

							//RETENCION TIMBRE
							 foreach($cheques as $CH){
				               if($OP[0]["cod_presi"]==$CH[0]["cod_presi"] && $OP[0]["cod_entidad"]==$CH[0]["cod_entidad"] && $OP[0]["cod_tipo_inst"]==$CH[0]["cod_tipo_inst"] && $OP[0]["cod_inst"]==$CH[0]["cod_inst"] && $OP[0]["cod_dep"]==$CH[0]["cod_dep"] && $OP[0]["cod_sector"]==$CH[0]["cod_sector"] && $OP[0]["cod_programa"]==$CH[0]["cod_programa"] && $OP[0]["cod_sub_prog"]==$CH[0]["cod_sub_prog"] && $OP[0]["cod_proyecto"]==$CH[0]["cod_proyecto"] && $OP[0]["cod_activ_obra"]==$CH[0]["cod_activ_obra"] && $OP[0]["cod_partida"]==$CH[0]["cod_partida"] && $OP[0]["cod_generica"]==$CH[0]["cod_generica"] && $OP[0]["cod_especifica"]==$CH[0]["cod_especifica"] && $OP[0]["cod_sub_espec"]==$CH[0]["cod_sub_espec"] && $OP[0]["cod_auxiliar"]==$CH[0]["cod_auxiliar"] && $OP[0]["numero_orden_pago"]==$CH[0]["numero_orden_pago"]  && $OP[0]["ano_orden_pago"]==$CH[0]["ano_orden_pago"]  && $CH[0]["clase_beneficiario"]==3){//  && $OP[0]["cod_entidad_bancaria"]==$CH[0]["cod_entidad_bancaria"]  && $OP[0]["cod_sucursal"]==$CH[0]["cod_sucursal"]  && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"]   && $OP[0]["cuenta_bancaria"]==$CH[0]["cuenta_bancaria"] && $OP[0]["numero_cheque"]==$CH[0]["numero_cheque"]
									$beneficiario=$CH[0]["beneficiario"];
									$fpdf->imprimir_fila_documento ($sisap,$CH[0]["numero_cheque"],$CH[0]["fecha_cheque"],0,$beneficiario,0,0,0,0,0,$CH[0]["monto"],'Retención timbre',0);
									$t_cheques=$t_cheques+$CH[0]["monto"];
				             }//fin if
							}//fin foreach cheques retencion timbre
	             }//fin if
				}//fin foreach

    	    }else if($tipo_docu==6){
    	    	$de_docu = 'Rendiciones';
    	    	$DISPONIBILIDAD=$DISPONIBILIDAD-$crono[0]["monto"];
    	    	$t_compromiso=$t_compromiso+$crono[0]["monto"];
			    $t_orden_pago=$t_orden_pago+$crono[0]["monto"];
			    $t_cheques=$t_cheques+$crono[0]["monto"];
			    $pmonto_compromiso = $crono[0]["monto"];
			    $pmonto_causado    = $crono[0]["monto"];
			    $pmonto__pagado    = $crono[0]["monto"];
			    $fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);
    	    }else if($tipo_docu==7){
    	    	$de_docu = 'Nota de Debito';
    	    	$DISPONIBILIDAD=$DISPONIBILIDAD-$crono[0]["monto"];
    	    	$t_compromiso=$t_compromiso+$crono[0]["monto"];
			    $t_orden_pago=$t_orden_pago+$crono[0]["monto"];
			    $t_cheques=$t_cheques+$crono[0]["monto"];
			    $pmonto_causado    = $crono[0]["monto"];
			    $pmonto__pagado    = $crono[0]["monto"];
			    $fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);
    	    }else if($tipo_docu==8){
    	    	$de_docu = 'Reintegro';
    	    	$DISPONIBILIDAD=$DISPONIBILIDAD+$crono[0]["monto_compromiso"];
    	    	$t_compromiso=$t_compromiso-$crono[0]["monto_compromiso"];
			    $t_orden_pago=$t_orden_pago-$crono[0]["monto_causado"];
			    $t_cheques=$t_cheques-$crono[0]["monto_pagado"];
			    $fpdf->imprimir_fila_documento ($sisap,$numero_documento,$fecha_documento,$tipo_docu,$beneficiario,$pmonto,$pmonto_disminucion,$pmonto_aumento,$pmonto_compromiso,$pmonto_causado,$pmonto_pagado,'',$DISPONIBILIDAD);
    	    }
    	    array_splice($CRONOLOGICO,$key_index,1);
    	    array_splice($DATOS,$key_index_datos,1);
        }
    }//fin foreach cronologico

    /**
	foreach($reformulacion as $ref){}//fin foreach
	$t_compromiso=0;
	$t_orden_pago=0;
	$t_cheques=0;
	foreach($RCompromisos as $RC){}//fin foreach
	foreach($OCompromisos as $OC){}//fin foreach OC
	foreach($OBcompromisos as $OB){}//fin foreach OB
	foreach($CScompromisos as $CS){}//fin foreach CS
	foreach($RENDICIONES as $RDC){}//RENDIONES
	foreach($NOTADEBITO as $NDD){}//Nota de debitos
	foreach($REINTEGRO as $REIN){}//Reintegro
	/**/
	//aqui la seccion que va a mostrar los totales por partida
	$fpdf->SetFont('vera','B',6);
	$fpdf->Cell(6.5,7,"",'TBL',0,'C');//------[partida]
	$fpdf->Cell(6.5,7,"",'TB',0,'C');//------[generica]
	$fpdf->Cell(6.5,7,"",'TB',0,'C');//------[especifica]
	$fpdf->Cell(6.5,7,"",'TB',0,'C');//------[sub-especifica]
	$fpdf->Cell(7,7,"",'TRB',0,'C');//-----[auxiliar]

	$fpdf->SetFont('vera','',6);
	$fpdf->Cell(46.5,7,"TOTAL PARTIDA",'TBL',0,'L');//para hacer espacio
	$fpdf->SetFont('vera','',5);
	$fpdf->Cell(20,7," ",'TBL',0,'L');//--------[tipo Documento]
	$fpdf->SetFont('vera','',6);
	$fpdf->Cell(13,7,"",'TBL',0,'C');//-----------[fecha Documento]
	$fpdf->Cell(20,7,"",'TBL',0,'C');//----------------[numero Documento]
	$fpdf->Cell(20,7,$sisap->Formato2($dato["asignacion_anual"]),'TBL',0,'R');//-----------------[ASIGNACION]
	$fpdf->Cell(20,7,$sisap->Formato2($t_aumento),'TBL',0,'R');//----------------[AUMENTO]
	$fpdf->Cell(20,7,$sisap->Formato2($t_disminucion),'TBL',0,'R');//----------------[DISMINUCION]
	$fpdf->Cell(20,7,$sisap->Formato2($t_compromiso),'TBL',0,'R');//----------------[COMPROMISO]
	$fpdf->Cell(20,7,$sisap->Formato2($t_orden_pago),'TBL',0,'R');//----------[CAUSADO]
	$fpdf->Cell(20,7,$sisap->Formato2($t_cheques),'TBL',0,'R');//----------[PAGADO]
	if($DISPONIBILIDAD<0){
               //$fpdf->SetTextColor(222,3,0);
	}
	$fpdf->Cell(0,7,$sisap->Formato2($DISPONIBILIDAD),'TRBL',1,'R');//--------[DISPONIBILIDAD]
    $fpdf->SetTextColor(0,0,0);

}//fin foreachs
//fin_ventana_barra_proceso();

}//fin if isset

$fpdf->Output('analisis_presupuesto_cronologico_'.date("d_m_Y_h_i").".pdf",'D');
?>