<?php
if(isset($subpartidas)){
?>

<table width="100%" border="1" cellspacing="0" cellpadding="0" class="tablacompromiso tablacompromiso2">
  <tr class="tr_negro" >
    <td class="td4" width='5%'>Año</td>
    <td class="td4" width='5%'>Sec</td>
    <td class="td4" width='5%'>Prog</td>
    <td class="td4" width='5%'>Sub Prog</td>
    <td class="td4" width='5%'>Proy</td>
    <td class="td4" width='5%'>Activ Obra</td>
    <td class="td4" width='5%'>Part</td>
    <td class="td4" width='5%'>Gen</td>
    <td class="td4" width='5%'>Espec</td>
    <td class="td4" width='5%'>Sub Espec</td>
    <td class="td4" width='5%'>Aux</td>
    <td class="td4" width='9%'>Disponibilidad Anual</td>
    <td class="td4" width='9%'>Disponibilidad Hasta la Fecha</td>
    <td class="td4" width='15%'>Monto Solicitar</td>
    <td class="td4" width='%' align="center">---</td>
  </tr>

<?php
if(isset($datos)){
	$i=0;
	$j=0;
$montoTOTAL=0;
$dispo_total=0;
$_SESSION["recursos"]=array();
//print_r($usados);
	foreach($datos as $row){
		$ano = $row['v_solicitud_cfpd05_p2']['ano'];
		$cod_sector = $row['v_solicitud_cfpd05_p2']['cod_sector'];
		$cod_programa = $row['v_solicitud_cfpd05_p2']['cod_programa'];
		$cod_sub_prog = $row['v_solicitud_cfpd05_p2']['cod_sub_prog'];
		$cod_proyecto = $row['v_solicitud_cfpd05_p2']['cod_proyecto'];
		$cod_activ_obra = $row['v_solicitud_cfpd05_p2']['cod_activ_obra'];
		$cod_partida = $row['v_solicitud_cfpd05_p2']['cod_partida'];
		$cod_generica = $row['v_solicitud_cfpd05_p2']['cod_generica'];
		$cod_especifica= $row['v_solicitud_cfpd05_p2']['cod_especifica'];
		$cod_sub_espec = $row['v_solicitud_cfpd05_p2']['cod_sub_espec'];
		$cod_auxiliar = $row['v_solicitud_cfpd05_p2']['cod_auxiliar'];
		$asig_anual = $row['v_solicitud_cfpd05_p2']['asignacion_anual_actualizada'];
		switch($mes){
			case '1':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['ene_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['ene_montoq'];
			break;
			case '2':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['feb_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['feb_montoq'];
			break;
			case '3':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['mar_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['mar_montoq'];
			break;
			case '4':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['abr_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['abr_montoq'];
			break;
			case '5':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['may_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['may_montoq'];
			break;
			case '6':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['jun_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['jun_montoq'];
			break;
			case '7':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom']+$row['v_solicitud_cfpd05_p2']['jul_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq']+$row['v_solicitud_cfpd05_p2']['jul_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['jul_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['jul_montoq'];
			break;
			case '8':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom']+$row['v_solicitud_cfpd05_p2']['jul_montom']+$row['v_solicitud_cfpd05_p2']['ago_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq']+$row['v_solicitud_cfpd05_p2']['jul_montoq']+$row['v_solicitud_cfpd05_p2']['ago_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['ago_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['ago_montoq'];
			break;
			case '9':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom']+$row['v_solicitud_cfpd05_p2']['jul_montom']+$row['v_solicitud_cfpd05_p2']['ago_montom']+$row['v_solicitud_cfpd05_p2']['sep_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq']+$row['v_solicitud_cfpd05_p2']['jul_montoq']+$row['v_solicitud_cfpd05_p2']['ago_montoq']+$row['v_solicitud_cfpd05_p2']['sep_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['sep_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['sep_montoq'];
			break;
			case '10':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom']+$row['v_solicitud_cfpd05_p2']['jul_montom']+$row['v_solicitud_cfpd05_p2']['ago_montom']+$row['v_solicitud_cfpd05_p2']['sep_montom']+$row['v_solicitud_cfpd05_p2']['oct_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq']+$row['v_solicitud_cfpd05_p2']['jul_montoq']+$row['v_solicitud_cfpd05_p2']['ago_montoq']+$row['v_solicitud_cfpd05_p2']['sep_montoq']+$row['v_solicitud_cfpd05_p2']['oct_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['oct_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['oct_montoq'];
			break;
			case '11':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom']+$row['v_solicitud_cfpd05_p2']['jul_montom']+$row['v_solicitud_cfpd05_p2']['ago_montom']+$row['v_solicitud_cfpd05_p2']['sep_montom']+$row['v_solicitud_cfpd05_p2']['oct_montom']+$row['v_solicitud_cfpd05_p2']['nov_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq']+$row['v_solicitud_cfpd05_p2']['jul_montoq']+$row['v_solicitud_cfpd05_p2']['ago_montoq']+$row['v_solicitud_cfpd05_p2']['sep_montoq']+$row['v_solicitud_cfpd05_p2']['oct_montoq']+$row['v_solicitud_cfpd05_p2']['nov_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['nov_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['nov_montoq'];
			break;
			case '12':
					$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom']+$row['v_solicitud_cfpd05_p2']['jul_montom']+$row['v_solicitud_cfpd05_p2']['ago_montom']+$row['v_solicitud_cfpd05_p2']['sep_montom']+$row['v_solicitud_cfpd05_p2']['oct_montom']+$row['v_solicitud_cfpd05_p2']['nov_montom']+$row['v_solicitud_cfpd05_p2']['dic_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq']+$row['v_solicitud_cfpd05_p2']['jul_montoq']+$row['v_solicitud_cfpd05_p2']['ago_montoq']+$row['v_solicitud_cfpd05_p2']['sep_montoq']+$row['v_solicitud_cfpd05_p2']['oct_montoq']+$row['v_solicitud_cfpd05_p2']['nov_montoq']+$row['v_solicitud_cfpd05_p2']['dic_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_p2']['dic_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_p2']['dic_montoq'];
			break;
		}
		//pr($row['v_solicitud_cfpd05_p2']);
		//$disponibilidad1= $row['v_solicitud_cfpd05_p2']['ene_montom']+$row['v_solicitud_cfpd05_p2']['feb_montom']+$row['v_solicitud_cfpd05_p2']['mar_montom']+$row['v_solicitud_cfpd05_p2']['abr_montom']+$row['v_solicitud_cfpd05_p2']['may_montom']+$row['v_solicitud_cfpd05_p2']['jun_montom']+$row['v_solicitud_cfpd05_p2']['jul_montom']+$row['v_solicitud_cfpd05_p2']['ago_montom']+$row['v_solicitud_cfpd05_p2']['sep_montom']+$row['v_solicitud_cfpd05_p2']['oct_montom']+$row['v_solicitud_cfpd05_p2']['nov_montom']+$row['v_solicitud_cfpd05_p2']['dic_montom'];
		//$disponibilidad2= $row['v_solicitud_cfpd05_p2']['ene_montoq']+$row['v_solicitud_cfpd05_p2']['feb_montoq']+$row['v_solicitud_cfpd05_p2']['mar_montoq']+$row['v_solicitud_cfpd05_p2']['abr_montoq']+$row['v_solicitud_cfpd05_p2']['may_montoq']+$row['v_solicitud_cfpd05_p2']['jun_montoq']+$row['v_solicitud_cfpd05_p2']['jul_montoq']+$row['v_solicitud_cfpd05_p2']['ago_montoq']+$row['v_solicitud_cfpd05_p2']['sep_montoq']+$row['v_solicitud_cfpd05_p2']['oct_montoq']+$row['v_solicitud_cfpd05_p2']['nov_montoq']+$row['v_solicitud_cfpd05_p2']['dic_montoq'];
		$disponibilidad1=$asig_anual;
		$disponibilidad2=$asig_anual;
		foreach($usados as $x){
			 $sector=$x[0]['cod_sector'];
			 $programa=$x[0]['cod_programa'];
			 $sub_prog=$x[0]['cod_sub_prog'];
			 $proyecto=$x[0]['cod_proyecto'];
			 $activ_obra=$x[0]['cod_activ_obra'];
			 $par=$x[0]['cod_partida'];
			 $generica = $x[0]['cod_generica'];
			 $especifica= $x[0]['cod_especifica'];
			 $sub_espec = $x[0]['cod_sub_espec'];
			 $auxiliar = $x[0]['cod_auxiliar'];
			if ($cod_sector==$sector && $cod_programa==$programa && $cod_sub_prog==$sub_prog && $cod_proyecto==$proyecto && $cod_activ_obra==$activ_obra && $cod_partida==$par && $cod_generica==$generica && $cod_especifica==$especifica && $cod_sub_espec==$sub_espec && $cod_auxiliar==$auxiliar){
			    $disponibilidad1=$sisap->Formato2($disponibilidad1);
				$disponibilidad1=$sisap->Formato1($disponibilidad1);
				//echo "<br>".$monto_actual1;
				$disponibilidad2=$sisap->Formato2($disponibilidad2);
				$disponibilidad2=$sisap->Formato1($disponibilidad2);
				$x[0]['monto_entregado']=$sisap->Formato2($x[0]['monto_entregado']);
				$x[0]['monto_entregado']=$sisap->Formato1($x[0]['monto_entregado']);
				$disponibilidad1=$disponibilidad1-$x[0]['monto_entregado'];
				$disponibilidad2=$disponibilidad2-$x[0]['monto_entregado'];
				break;
				/*if($x[0]['monto_entregado']==0){
					$x[0]['monto']=$sisap->Formato2($x[0]['monto']);
					$x[0]['monto']=$sisap->Formato1($x[0]['monto']);
					$disponibilidad1=$disponibilidad1-$x[0]['monto'];
					$disponibilidad2=$disponibilidad2-$x[0]['monto'];
					break;
				}else{
					$x[0]['monto_entregado']=$sisap->Formato2($x[0]['monto']);
					$x[0]['monto_entregado']=$sisap->Formato1($x[0]['monto']);
					$disponibilidad1=$disponibilidad1-$x[0]['monto_entregado'];
					$disponibilidad2=$disponibilidad2-$x[0]['monto_entregado'];
					break;
				}*/
			}
		}
		$monto_aux1=$monto_actual1;
		$monto_aux2=$monto_actual2;
		if($asig_anual>0 || $asig_anual!=0 ){
			///////////////////////manejar estas condiciones para no ver errores en falcon/////////////
			if($disponibilidad1<=0){
//				$disponibilidad1=0;
			}
			if($disponibilidad2<=0){
//				$disponibilidad2=0;
			}
			if($monto_actual1 > $disponibilidad1){
				$monto_actual1=$disponibilidad1;
				$monto_aux1=$disponibilidad1;
			}
			if($monto_actual2 > $disponibilidad2){
				$monto_actual2=$disponibilidad2;
				$monto_aux2=$disponibilidad2;
			}
			if($monto_actual1 <=0){
				$monto_aux1=0;

			}
			if($monto_actual2 <= 0){
				$monto_aux2=0;
			}
		}else{
			/*$disponibilidad1=0;
			$disponibilidad2=0;*/
			$monto_aux1=0;
			$monto_aux2=0;
		}
	if($i%2==0){
		$color="#CDF2FF";
	}else{
		$color="#DAEBFF";
	}
	?>
	<tr class="textNegro2" bgcolor="<?=$color?>" id="<?= "fila_".$i ?>" onclick="new Effect.Highlight(this);">
	<td class="td2center">
		<?= $ano?>
	</td>
	<td class="td2center">
		<?=$sisap->AddCero3($cod_sector);?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_programa); ?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_sub_prog);?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_proyecto);?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_activ_obra); ?>
	</td>
	<td class="td2center">
		<?=$cod_partida?>
	</td>
	<td class="td2center">
		<?=$sisap->AddCero3($cod_generica)?>
	</td>
	<td class="td2center">
		<?=$sisap->AddCero3($cod_especifica)?>
	</td>
	<td class="td2center">
		<?=$sisap->AddCero3($cod_sub_espec)?>
	</td>
	<td class="td2center">
		<?=$sisap->AddCero3($cod_auxiliar)?>
	</td>

	<?if($frecuencia==1){
		$monto_enviar=$monto_actual2;
		/*if($monto_actual1>0 || $monto_actual2>0){
			$montoTOTAL+=$monto_actual2;
			//$montoTOTAL+=$monto_actual1;
		}*/
		$montoTOTAL+=$monto_aux2;
		 ?>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($asig_anual)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($disponibilidad2)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>

	<td class="td2" align='right'>
		<?= $sisap->inputTagRemote('csrp01_solicitud_recurso2/monto_solicitar2', array('value'=>$sisap->Formato2($monto_aux2),'url1'=>'/csrp01_solicitud_recurso/monto_solicitar/'.$i.'/'.$monto_enviar.'/', 'update1'=>'input_'.$i,'id'=>'input_tag'.$i,'style'=>'width:98%;text-align:right','readonly'=>'readonly','onKeyPress'=>'return solonumeros_con_punto(event);',"onChange"=>"moneda('input_tag".$i."');"),  $optionAttr = null,  $showEmpty = true, $return = false) ?>
	</td>
	<?}else{
		$monto_enviar=$monto_actual1;
		/*if($monto_actual1>0 || $monto_actual2>0){
			//$montoTOTAL+=$monto_actual2;
			$montoTOTAL+=$monto_actual1;
		}*/
		$montoTOTAL+=$monto_aux1;
		 ?>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($asig_anual)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($disponibilidad1)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>

	<td class="td2" align='right'>
		<?= $sisap->inputTagRemote('csrp01_solicitud_recurso2/monto_solicitar2', array('value'=>$sisap->Formato2($monto_aux1),'url1'=>'/csrp01_solicitud_recurso/monto_solicitar/'.$i.'/'.$monto_enviar.'/', 'update1'=>'input_'.$i,'id'=>'input_tag'.$i,'style'=>'width:98%;text-align:right','readonly'=>'readonly','onKeyPress'=>'return solonumeros_con_punto(event);',"onChange"=>"moneda('input_tag".$i."');"),  $optionAttr = null,  $showEmpty = true, $return = false) ?>
	</td>
	<? } ?>
	<td id="<?="input_".$i?>" align='center'>
	<a href="javascript:ver_documento('/csrp01_solicitud_recurso/modificar_monto/cancelar/<?=$i?>/<?=$monto_enviar?>','<?="input_".$i?>');"  id="numero_td"><?=$html->image('edit.png',array('border'=>'0', 'width'=>'20', 'height'=>'15', 'title'=>'Modificar el monto a solicitar'))?></a><?= $ajax->link($html->image('delete.png',array('border'=>0)), '/csrp01_solicitud_recurso/eliminar_items_recurso/'.$i.'/subpartidas', array('update'=>'grilla','title'=>'Eliminar',"after"=>"new Effect.DropOut('fila_$i');"),'Realmente desea eliminar esta fila de la Lista?',false,true) ?></td>
	</tr>

	<?php
	$vec[$i]['ano']=$row['v_solicitud_cfpd05_p2']['ano'];
	$vec[$i]['cod_sector']=$row['v_solicitud_cfpd05_p2']['cod_sector'];
	$vec[$i]['cod_prog']=$row['v_solicitud_cfpd05_p2']['cod_programa'];
	$vec[$i]['cod_sub_prog']=$row['v_solicitud_cfpd05_p2']['cod_sub_prog'];
	$vec[$i]['cod_proy']=$row['v_solicitud_cfpd05_p2']['cod_proyecto'];
	$vec[$i]['cod_activ_obra']=$row['v_solicitud_cfpd05_p2']['cod_activ_obra'];
	$vec[$i]['cod_partida']=$row['v_solicitud_cfpd05_p2']['cod_partida'];
	$vec[$i]['cod_generica']=$row['v_solicitud_cfpd05_p2']['cod_generica'];
	$vec[$i]['cod_especifica']=$row['v_solicitud_cfpd05_p2']['cod_especifica'];
	$vec[$i]['cod_sub_espec']=$row['v_solicitud_cfpd05_p2']['cod_sub_espec'];
	$vec[$i]['cod_auxiliar']=$row['v_solicitud_cfpd05_p2']['cod_auxiliar'];
//	echo "<br>".$monto_actual1;
	if($frecuencia==1){
		$vec[$i]['disponibilidad']=$disponibilidad2;
		$vec[$i]['monto']=$monto_actual2;
	}else{
		$vec[$i]['disponibilidad']=$disponibilidad1;
	    $vec[$i]['monto']=$monto_actual1;
	}
	$vec[$i]['asig_anual']=$asig_anual;//agregue esto
	$vec[$i]['id']=$i;
	$_SESSION["recursos"]=$_SESSION["recursos"]+$vec;

	$i++;
} ?>
<tr id="carga_monto_actual">
	<td colspan='13' align='right'>TOTAL PARTIDAS Bs.</td>
	<td  align='right' id="cambio_monto"><?= $sisap->Formato2($montoTOTAL);?></td>
	<td align='center' >---</td>
	<input type="hidden" id="oculto" value="<?=$montoTOTAL?>"/>
</tr>
<?
}else{


?>
<tr>
<td class="td2center">
---
</td>
<td class="td2center">
---
</td>
<td class="td2center">
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
</tr>

<?php
}
?>
</table>

<? }else if(isset($partidas)){ ?>

	<table width="100%" border="1" cellspacing="0" cellpadding="0" class="tablacompromiso tablacompromiso2">
  <tr class="tr_negro" >
    <td class="td4" width='6%'>Año</td>
    <td class="td4" width='6%'>Sec</td>
    <td class="td4" width='6%'>Prog</td>
    <td class="td4" width='6%'>Sub Prog</td>
    <td class="td4" width='6%'>Proy</td>
    <td class="td4" width='6%'>Activ Obra</td>
    <td class="td4" width='6%'>Part</td>
    <td class="td4" width='17%'>Disponibilidad Anual</td>
    <td class="td4" width='17%'>Disponibilidad Hasta la Fecha</td>
    <td class="td4" width='17%'>Monto Solicitar</td>
     <td class="td4" align="center" width='7%'>---</td>
  </tr>

<?php
if(isset($datos)){
	$i=0;
	$j=0;
$montoTOTAL=0;
$dispo_total=0;
$_SESSION["recursos"]=array();
	foreach($datos as $row){
		$ano = $row['v_solicitud_cfpd05_pp2']['ano'];
		$cod_sector = $row['v_solicitud_cfpd05_pp2']['cod_sector'];
		$cod_programa = $row['v_solicitud_cfpd05_pp2']['cod_programa'];
		$cod_sub_prog = $row['v_solicitud_cfpd05_pp2']['cod_sub_prog'];
		$cod_proyecto = $row['v_solicitud_cfpd05_pp2']['cod_proyecto'];
		$cod_activ_obra = $row['v_solicitud_cfpd05_pp2']['cod_activ_obra'];
		$cod_partida = $row['v_solicitud_cfpd05_pp2']['cod_partida'];
		$asig_anual = $row['v_solicitud_cfpd05_pp2']['asignacion_anual_actualizada'];
		switch($mes){
			case '1':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['ene_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['ene_montoq'];
			break;
			case '2':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['feb_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['feb_montoq'];
			break;
			case '3':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['mar_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['mar_montoq'];
			break;
			case '4':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['abr_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['abr_montoq'];
			break;
			case '5':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['may_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['may_montoq'];
			break;
			case '6':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['jun_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['jun_montoq'];
			break;
			case '7':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom']+$row['v_solicitud_cfpd05_pp2']['jul_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq']+$row['v_solicitud_cfpd05_pp2']['jul_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['jul_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['jul_montoq'];
			break;
			case '8':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom']+$row['v_solicitud_cfpd05_pp2']['jul_montom']+$row['v_solicitud_cfpd05_pp2']['ago_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq']+$row['v_solicitud_cfpd05_pp2']['jul_montoq']+$row['v_solicitud_cfpd05_pp2']['ago_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['ago_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['ago_montoq'];
			break;
			case '9':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom']+$row['v_solicitud_cfpd05_pp2']['jul_montom']+$row['v_solicitud_cfpd05_pp2']['ago_montom']+$row['v_solicitud_cfpd05_pp2']['sep_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq']+$row['v_solicitud_cfpd05_pp2']['jul_montoq']+$row['v_solicitud_cfpd05_pp2']['ago_montoq']+$row['v_solicitud_cfpd05_pp2']['sep_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['sep_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['sep_montoq'];
			break;
			case '10':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom']+$row['v_solicitud_cfpd05_pp2']['jul_montom']+$row['v_solicitud_cfpd05_pp2']['ago_montom']+$row['v_solicitud_cfpd05_pp2']['sep_montom']+$row['v_solicitud_cfpd05_pp2']['oct_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq']+$row['v_solicitud_cfpd05_pp2']['jul_montoq']+$row['v_solicitud_cfpd05_pp2']['ago_montoq']+$row['v_solicitud_cfpd05_pp2']['sep_montoq']+$row['v_solicitud_cfpd05_pp2']['oct_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['oct_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['oct_montoq'];
			break;
			case '11':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom']+$row['v_solicitud_cfpd05_pp2']['jul_montom']+$row['v_solicitud_cfpd05_pp2']['ago_montom']+$row['v_solicitud_cfpd05_pp2']['sep_montom']+$row['v_solicitud_cfpd05_pp2']['oct_montom']+$row['v_solicitud_cfpd05_pp2']['nov_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq']+$row['v_solicitud_cfpd05_pp2']['jul_montoq']+$row['v_solicitud_cfpd05_pp2']['ago_montoq']+$row['v_solicitud_cfpd05_pp2']['sep_montoq']+$row['v_solicitud_cfpd05_pp2']['oct_montoq']+$row['v_solicitud_cfpd05_pp2']['nov_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['nov_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['nov_montoq'];
			break;
			case '12':
					$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom']+$row['v_solicitud_cfpd05_pp2']['jul_montom']+$row['v_solicitud_cfpd05_pp2']['ago_montom']+$row['v_solicitud_cfpd05_pp2']['sep_montom']+$row['v_solicitud_cfpd05_pp2']['oct_montom']+$row['v_solicitud_cfpd05_pp2']['nov_montom']+$row['v_solicitud_cfpd05_pp2']['dic_montom'];
					$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq']+$row['v_solicitud_cfpd05_pp2']['jul_montoq']+$row['v_solicitud_cfpd05_pp2']['ago_montoq']+$row['v_solicitud_cfpd05_pp2']['sep_montoq']+$row['v_solicitud_cfpd05_pp2']['oct_montoq']+$row['v_solicitud_cfpd05_pp2']['nov_montoq']+$row['v_solicitud_cfpd05_pp2']['dic_montoq'];
					$monto_actual1=$row['v_solicitud_cfpd05_pp2']['dic_montom'];
					$monto_actual2=$row['v_solicitud_cfpd05_pp2']['dic_montoq'];
			break;
		}
		//$disponibilidad1= $row['v_solicitud_cfpd05_pp2']['ene_montom']+$row['v_solicitud_cfpd05_pp2']['feb_montom']+$row['v_solicitud_cfpd05_pp2']['mar_montom']+$row['v_solicitud_cfpd05_pp2']['abr_montom']+$row['v_solicitud_cfpd05_pp2']['may_montom']+$row['v_solicitud_cfpd05_pp2']['jun_montom']+$row['v_solicitud_cfpd05_pp2']['jul_montom']+$row['v_solicitud_cfpd05_pp2']['ago_montom']+$row['v_solicitud_cfpd05_pp2']['sep_montom']+$row['v_solicitud_cfpd05_pp2']['oct_montom']+$row['v_solicitud_cfpd05_pp2']['nov_montom']+$row['v_solicitud_cfpd05_pp2']['dic_montom'];
		//$disponibilidad2= $row['v_solicitud_cfpd05_pp2']['ene_montoq']+$row['v_solicitud_cfpd05_pp2']['feb_montoq']+$row['v_solicitud_cfpd05_pp2']['mar_montoq']+$row['v_solicitud_cfpd05_pp2']['abr_montoq']+$row['v_solicitud_cfpd05_pp2']['may_montoq']+$row['v_solicitud_cfpd05_pp2']['jun_montoq']+$row['v_solicitud_cfpd05_pp2']['jul_montoq']+$row['v_solicitud_cfpd05_pp2']['ago_montoq']+$row['v_solicitud_cfpd05_pp2']['sep_montoq']+$row['v_solicitud_cfpd05_pp2']['oct_montoq']+$row['v_solicitud_cfpd05_pp2']['nov_montoq']+$row['v_solicitud_cfpd05_pp2']['dic_montoq'];
		$disponibilidad1=$asig_anual;
		$disponibilidad2=$asig_anual;
		foreach($usados as $x){
			 $sector=$x[0]['cod_sector'];
			 $programa=$x[0]['cod_programa'];
			 $sub_prog=$x[0]['cod_sub_prog'];
			 $proyecto=$x[0]['cod_proyecto'];
			 $activ_obra=$x[0]['cod_activ_obra'];
			 $par=$x[0]['cod_partida'];


			if ($cod_sector==$sector && $cod_programa==$programa && $cod_sub_prog==$sub_prog && $cod_proyecto==$proyecto && $cod_activ_obra==$activ_obra && $cod_partida==$par){
				//$disponibilidad1=$disponibilidad1-$x[0]['monto'];
				//echo $disponibilidad1=$sisap->Formato2($disponibilidad1);
				$disponibilidad1=$sisap->Formato2($disponibilidad1);
				$disponibilidad1=$sisap->Formato1($disponibilidad1);
				$disponibilidad2=$sisap->Formato2($disponibilidad2);
				$disponibilidad2=$sisap->Formato1($disponibilidad2);

				$x[0]['monto_entregado']=$sisap->Formato2($x[0]['monto_entregado']);
				$x[0]['monto_entregado']=$sisap->Formato1($x[0]['monto_entregado']);
				$disponibilidad1=$disponibilidad1-$x[0]['monto_entregado'];
				$disponibilidad2=$disponibilidad2-$x[0]['monto_entregado'];
				break;
				/*
				if($x[0]['monto_entregado']==0){echo "si";
					$x[0]['monto']=$sisap->Formato2($x[0]['monto']);
					$x[0]['monto']=$sisap->Formato1($x[0]['monto']);
					$disponibilidad1=$disponibilidad1-$x[0]['monto'];
					$disponibilidad2=$disponibilidad2-$x[0]['monto'];
					break;
				}else{echo "sino";
					$x[0]['monto_entregado']=$sisap->Formato2($x[0]['monto_entregado']);
					$x[0]['monto_entregado']=$sisap->Formato1($x[0]['monto_entregado']);
					$disponibilidad1=$disponibilidad1-$x[0]['monto_entregado'];
					$disponibilidad2=$disponibilidad2-$x[0]['monto_entregado'];
					break;
				}
				$x[0]['monto']=$sisap->Formato2($x[0]['monto']);
				$x[0]['monto']=$sisap->Formato1($x[0]['monto']);
				$disponibilidad1=$disponibilidad1-$x[0]['monto'];
				$disponibilidad2=$disponibilidad2-$x[0]['monto'];
				$monto_actual2;
				break;*/
			}
		}
		$monto_aux1=$monto_actual1;
		$monto_aux2=$monto_actual2;
		if($asig_anual>0 || $asig_anual!=0 ){
			///////////////////////manejar estas condiciones para no ver errores en falcon/////////////
			if($disponibilidad1<=0){
//				$disponibilidad1=0;
			}
			if($disponibilidad2<=0){
//				$disponibilidad2=0;
			}
			if($monto_actual1 > $disponibilidad1){
				$monto_actual1=$disponibilidad1;
				$monto_aux1=$disponibilidad1;
			}
			if($monto_actual2 > $disponibilidad2){
				$monto_actual2=$disponibilidad2;
				$monto_aux2=$disponibilidad2;
			}
			if($monto_actual1 <=0){
				$monto_aux1=0;
			}
			if($monto_actual2 <= 0){
				$monto_aux2=0;
			}
		}else{
			/*$disponibilidad1=0;
			$disponibilidad2=0;*/
			$monto_aux1=0;
			$monto_aux2=0;
		}
		//$disponibilidad1=$disponibilidad1-$monto_actual1;
		//$disponibilidad2=$disponibilidad2-$monto_actual2;
	if($i%2==0){
		$color="#CDF2FF";
	}else{
		$color="#DAEBFF";
	}
	?>
	<tr class="textNegro2" bgcolor="<?=$color?>" id="<?= "fila_".$i ?>" onclick="new Effect.Highlight(this);">
	<td class="td2center">
		<?= $ano?>
	</td>
	<td class="td2center">
		<?=$sisap->AddCero3($cod_sector);?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_programa); ?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_sub_prog);?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_proyecto);?>
	</td>
	<td class="td2center">
		<?= $sisap->AddCero3($cod_activ_obra); ?>
	</td>
	<td class="td2center">
		<?=$cod_partida ?>
	</td>

	<?if($frecuencia==1){
		$monto_enviar=$monto_actual2;
	/*	if($monto_actual1>0 || $monto_actual2>0){
			$montoTOTAL+=$monto_actual2;
			//$montoTOTAL+=$monto_actual1;
		}*/
		$montoTOTAL+=$monto_aux2;
	?>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($asig_anual)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($disponibilidad2)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>

	<td class="td2" align='right' ><!-- aqui cambie la variable $monto_actual2 por la $disponibilidad2 -->
		<?= $sisap->inputTagRemote('csrp01_solicitud_recurso2/monto_solicitar2', array('value'=>$sisap->Formato2($monto_aux2),'url1'=>'/csrp01_solicitud_recurso/monto_solicitar/'.$i.'/'.$monto_enviar, 'update1'=>'input_'.$i,'id'=>'input_tag'.$i,'style'=>'width:98%;text-align:right','readonly'=>'readonly','onKeyPress'=>'return solonumeros_con_punto(event);',"onChange"=>"moneda('input_tag".$i."');"),  $optionAttr = null,  $showEmpty = true, $return = false) ?>
	</td>
	<?}else{
		$monto_enviar=$monto_actual1;
		/*if($monto_actual1>0 || $monto_actual2>0){
			//$montoTOTAL+=$monto_actual2;
			$montoTOTAL+=$monto_actual1;
		}*/
		$montoTOTAL+=$monto_aux1;
		?>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($asig_anual)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>
	<td class="td2center" id="dispo" >
		<input name="data[csrp01_solicitud_recurso2][disponible]" style='text-align:right' value="<?=$sisap->Formato2($disponibilidad1)?>" id="disponible" onKeyPress="return solonumeros(event);" class="inputtext" readonly>
	</td>

	<td class="td2" align='right'><!-- aqui cambie la variable $monto_actual1 por la $disponibilidad1 -->
		<?= $sisap->inputTagRemote('csrp01_solicitud_recurso2/monto_solicitar2', array('value'=>$sisap->Formato2($monto_aux1),'url1'=>'/csrp01_solicitud_recurso/monto_solicitar/'.$i.'/'.$monto_enviar.'/', 'update1'=>'input_'.$i,'id'=>'input_tag'.$i,'style'=>'width:98%;text-align:right','readonly'=>'readonly','onKeyPress'=>'return solonumeros_con_punto(event);',"onChange"=>"moneda('input_tag".$i."');"),  $optionAttr = null,  $showEmpty = true, $return = false) ?>
	</td>
	<? } ?>

	<td id="<?="input_".$i?>" align='center'>
	<a href="javascript:ver_documento('/csrp01_solicitud_recurso/modificar_monto/cancelar/<?=$i?>/<?=$monto_enviar?>','<?="input_".$i?>');"  id="numero_td"><?=$html->image('edit.png',array('border'=>'0', 'width'=>'20', 'height'=>'15', 'title'=>'Modificar el monto a solicitar'))?></a><?= $ajax->link($html->image('delete.png',array('border'=>0)), '/csrp01_solicitud_recurso/eliminar_items_recurso/'.$i.'/partidas', array('update'=>'grilla','title'=>'Eliminar',"after"=>"new Effect.DropOut('fila_$i');"),'Realmente desea eliminar esta fila de la Lista?',false,true) ?></td>
	</tr>
	<?php
	$vec[$i]['ano']=$row['v_solicitud_cfpd05_pp2']['ano'];
	$vec[$i]['cod_sector']=$row['v_solicitud_cfpd05_pp2']['cod_sector'];
	$vec[$i]['cod_prog']=$row['v_solicitud_cfpd05_pp2']['cod_programa'];
	$vec[$i]['cod_sub_prog']=$row['v_solicitud_cfpd05_pp2']['cod_sub_prog'];
	$vec[$i]['cod_proy']=$row['v_solicitud_cfpd05_pp2']['cod_proyecto'];
	$vec[$i]['cod_activ_obra']=$row['v_solicitud_cfpd05_pp2']['cod_activ_obra'];
	$vec[$i]['cod_partida']=$row['v_solicitud_cfpd05_pp2']['cod_partida'];
	//$vec[$i]['asig_anual']=$asig_anual;//agregue esto
//	echo "<br>".$monto_actual1;
	if($frecuencia==1){

		$vec[$i]['disponibilidad']=$disponibilidad2;
		$vec[$i]['monto']=$monto_actual2;
		//$vec[$i]['monto']=$disponibilidad2;
	}else{
		$vec[$i]['disponibilidad']=$disponibilidad1;
	    $vec[$i]['monto']=$monto_actual1;
	    //$vec[$i]['monto']=$disponibilidad1;
	}
	$vec[$i]['asig_anual']=$asig_anual;//agregue esto
	$vec[$i]['id']=$i;
	$_SESSION["recursos"]=$_SESSION["recursos"]+$vec;

	$i++;
} ?>
<tr id="carga_monto_actual">
	<td colspan='9' align='right'>TOTAL PARTIDAS Bs.</td>
	<td  id="cambio_monto" align='right' ><?= $sisap->Formato2($montoTOTAL);?></td>
	<td  align='center' >---</td>
	<input type="hidden" id="oculto" value="<?=$montoTOTAL?>"/>
</tr>
<?
}else{


?>
<tr>
<td class="td2center">
---
</td>
<td class="td2center">
---
</td>
<td class="td2center">
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
<td class="td2center"	>
---
</td>
</tr>
<?php
   }
}
?>
</table>
<? //print_r($_SESSION["recursos"])?>


