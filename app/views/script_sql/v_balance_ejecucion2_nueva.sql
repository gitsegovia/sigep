-- View: v_balance_ejecucion2

 DROP VIEW v_balance_ejecucion2 cascade;

CREATE OR REPLACE VIEW v_balance_ejecucion2 AS 
 SELECT a.cod_presi,
a.cod_entidad,
a.cod_tipo_inst,
a.cod_inst,
a.cod_dep,
a.ano,
a.cod_sector,
upper(( SELECT a1.denominacion
           FROM cfpd02_sector a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector)) AS deno_sector,
a.cod_programa,
upper(( SELECT a1.denominacion
           FROM cfpd02_programa a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa)) AS deno_programa,
a.cod_sub_prog,
upper(( SELECT a1.denominacion
           FROM cfpd02_sub_prog a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog)) AS deno_sub_prog,
a.cod_proyecto,
upper(( SELECT a1.denominacion
           FROM cfpd02_proyecto a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog AND a1.cod_proyecto = a.cod_proyecto)) AS deno_proyecto,
a.cod_activ_obra,
upper(( SELECT a1.denominacion
           FROM cfpd02_activ_obra a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog AND a1.cod_proyecto = a.cod_proyecto AND a1.cod_activ_obra = a.cod_activ_obra)) AS deno_activ_obra,
a.cod_partida,
a.cod_generica,
a.cod_especifica,
a.cod_sub_espec,
upper(( SELECT a1.denominacion
           FROM cfpd01_ano_5_sub_espec a1
          WHERE a1.ejercicio = a.ano AND a1.cod_grupo = 4 AND a1.cod_partida = substr(a.cod_partida::text,
2,
2)::integer AND a1.cod_generica = a.cod_generica AND a1.cod_especifica = a.cod_especifica AND a1.cod_sub_espec = a.cod_sub_espec)) AS deno_sub_espec,
a.cod_auxiliar,
upper(( SELECT a1.denominacion
           FROM cfpd05_auxiliar a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog AND a1.cod_proyecto = a.cod_proyecto AND a1.cod_activ_obra = a.cod_activ_obra AND a1.cod_partida = a.cod_partida AND a1.cod_generica = a.cod_generica AND a1.cod_especifica = a.cod_especifica AND a1.cod_sub_espec = a.cod_sub_espec AND a1.cod_auxiliar = a.cod_auxiliar)) AS deno_auxiliar,
a.asignacion_anual,
(a.aumento_traslado_ene + a.credito_adicional_ene)::numeric(22,2) AS aumento_ene,
(a.aumento_traslado_feb + a.credito_adicional_feb)::numeric(22,2) AS aumento_feb,
(a.aumento_traslado_mar + a.credito_adicional_mar)::numeric(22,2) AS aumento_mar,
(a.aumento_traslado_abr + a.credito_adicional_abr)::numeric(22,2) AS aumento_abr,
(a.aumento_traslado_may + a.credito_adicional_may)::numeric(22,2) AS aumento_may,
(a.aumento_traslado_jun + a.credito_adicional_jun)::numeric(22,2) AS aumento_jun,
(a.aumento_traslado_jul + a.credito_adicional_jul)::numeric(22,2) AS aumento_jul,
(a.aumento_traslado_ago + a.credito_adicional_ago)::numeric(22,2) AS aumento_ago,
(a.aumento_traslado_sep + a.credito_adicional_sep)::numeric(22,2) AS aumento_sep,
(a.aumento_traslado_oct + a.credito_adicional_oct)::numeric(22,2) AS aumento_oct,
(a.aumento_traslado_nov + a.credito_adicional_nov)::numeric(22,2) AS aumento_nov,
(a.aumento_traslado_dic + a.credito_adicional_dic)::numeric(22,2) AS aumento_dic,
(a.disminucion_traslado_ene + a.rebaja_ene)::numeric(22,2) AS disminucion_ene,
(a.disminucion_traslado_feb + a.rebaja_feb)::numeric(22,2) AS disminucion_feb,
(a.disminucion_traslado_mar + a.rebaja_mar)::numeric(22,2) AS disminucion_mar,
(a.disminucion_traslado_abr + a.rebaja_abr)::numeric(22,2) AS disminucion_abr,
(a.disminucion_traslado_may + a.rebaja_may)::numeric(22,2) AS disminucion_may,
(a.disminucion_traslado_jun + a.rebaja_jun)::numeric(22,2) AS disminucion_jun,
(a.disminucion_traslado_jul + a.rebaja_jul)::numeric(22,2) AS disminucion_jul,
(a.disminucion_traslado_ago + a.rebaja_ago)::numeric(22,2) AS disminucion_ago,
(a.disminucion_traslado_sep + a.rebaja_sep)::numeric(22,2) AS disminucion_sep,
(a.disminucion_traslado_oct + a.rebaja_oct)::numeric(22,2) AS disminucion_oct,
(a.disminucion_traslado_nov + a.rebaja_nov)::numeric(22,2) AS disminucion_nov,
(a.disminucion_traslado_dic + a.rebaja_dic)::numeric(22,2) AS disminucion_dic,
a.compromiso_ene,
a.causado_ene,
a.pagado_ene,
a.compromiso_feb,
a.causado_feb,
a.pagado_feb,
a.compromiso_mar,
a.causado_mar,
a.pagado_mar,
a.compromiso_abr,
a.causado_abr,
a.pagado_abr,
a.compromiso_may,
a.causado_may,
a.pagado_may,
a.compromiso_jun,
a.causado_jun,
a.pagado_jun,
a.compromiso_jul,
a.causado_jul,
a.pagado_jul,
a.compromiso_ago,
a.causado_ago,
a.pagado_ago,
a.compromiso_sep,
a.causado_sep,
a.pagado_sep,
a.compromiso_oct,
a.causado_oct,
a.pagado_oct,
a.compromiso_nov,
a.causado_nov,
a.pagado_nov,
a.compromiso_dic,
a.causado_dic,
a.pagado_dic,
(a.causado_ene - a.pagado_ene)::numeric(22,2) AS deuda_ene,
(a.causado_feb - a.pagado_feb)::numeric(22,2) AS deuda_feb,
(a.causado_mar - a.pagado_mar)::numeric(22,2) AS deuda_mar,
(a.causado_abr - a.pagado_abr)::numeric(22,2) AS deuda_abr,
(a.causado_may - a.pagado_may)::numeric(22,2) AS deuda_may,
(a.causado_jun - a.pagado_jun)::numeric(22,2) AS deuda_jun,
(a.causado_jul - a.pagado_jul)::numeric(22,2) AS deuda_jul,
(a.causado_ago - a.pagado_ago)::numeric(22,2) AS deuda_ago,
(a.causado_sep - a.pagado_sep)::numeric(22,2) AS deuda_sep,
(a.causado_oct - a.pagado_oct)::numeric(22,2) AS deuda_oct,
(a.causado_nov - a.pagado_nov)::numeric(22,2) AS deuda_nov,
(a.causado_dic - a.pagado_dic)::numeric(22,2) AS deuda_dic,
a.asignacion_anual AS enerom,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene))::numeric(22,2) AS febrerom,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb))::numeric(22,2) AS marzom,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar))::numeric(22,2) AS abrilm,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr))::numeric(22,2) AS mayom,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may))::numeric(22,2) AS juniom,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun))::numeric(22,2) AS juliom,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul))::numeric(22,2) AS agostom,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago))::numeric(22,2) AS septiembrem,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago + a.aumento_traslado_sep + a.credito_adicional_sep - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago + a.disminucion_traslado_sep + a.rebaja_sep + a.compromiso_sep))::numeric(22,2) AS octubrem,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago + a.aumento_traslado_sep + a.credito_adicional_sep + a.aumento_traslado_oct + a.credito_adicional_oct - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago + a.disminucion_traslado_sep + a.rebaja_sep + a.compromiso_sep + a.disminucion_traslado_oct + a.rebaja_oct + a.compromiso_oct))::numeric(22,2) AS noviembrem,
(a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago + a.aumento_traslado_sep + a.credito_adicional_sep + a.aumento_traslado_oct + a.credito_adicional_oct + a.aumento_traslado_nov + a.credito_adicional_nov - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago + a.disminucion_traslado_sep + a.rebaja_sep + a.compromiso_sep + a.disminucion_traslado_oct + a.rebaja_oct + a.compromiso_oct + a.disminucion_traslado_nov + a.rebaja_nov + a.compromiso_nov))::numeric(22,2) AS diciembrem,
a.tipo_presupuesto 
   FROM cfpd05 a;

ALTER TABLE v_balance_ejecucion2 OWNER TO sisap;


CREATE OR REPLACE VIEW v_balance_ejecucion2_inst AS 
 SELECT a.cod_presi,
a.cod_entidad,
a.cod_tipo_inst,
a.cod_inst,
a.ano,
a.cod_sector,
a.deno_sector,
a.cod_programa,
a.deno_programa,
a.cod_sub_prog,
a.deno_sub_prog,
a.cod_proyecto,
a.deno_proyecto,
a.cod_activ_obra,
a.deno_activ_obra,
a.cod_partida,
a.cod_generica,
a.cod_especifica,
a.cod_sub_espec,
a.deno_sub_espec,
a.cod_auxiliar,
a.deno_auxiliar,
sum(a.asignacion_anual) AS asignacion_anual,
sum(a.aumento_ene) AS aumento_ene,
sum(a.aumento_feb) AS aumento_feb,
sum(a.aumento_mar) AS aumento_mar,
sum(a.aumento_abr) AS aumento_abr,
sum(a.aumento_may) AS aumento_may,
sum(a.aumento_jun) AS aumento_jun,
sum(a.aumento_jul) AS aumento_jul,
sum(a.aumento_ago) AS aumento_ago,
sum(a.aumento_sep) AS aumento_sep,
sum(a.aumento_oct) AS aumento_oct,
sum(a.aumento_nov) AS aumento_nov,
sum(a.aumento_dic) AS aumento_dic,
sum(a.disminucion_ene) AS disminucion_ene,
sum(a.disminucion_feb) AS disminucion_feb,
sum(a.disminucion_mar) AS disminucion_mar,
sum(a.disminucion_abr) AS disminucion_abr,
sum(a.disminucion_may) AS disminucion_may,
sum(a.disminucion_jun) AS disminucion_jun,
sum(a.disminucion_jul) AS disminucion_jul,
sum(a.disminucion_ago) AS disminucion_ago,
sum(a.disminucion_sep) AS disminucion_sep,
sum(a.disminucion_oct) AS disminucion_oct,
sum(a.disminucion_nov) AS disminucion_nov,
sum(a.disminucion_dic) AS disminucion_dic,
sum(a.compromiso_ene) AS compromiso_ene,
sum(a.causado_ene) AS causado_ene,
sum(a.pagado_ene) AS pagado_ene,
sum(a.compromiso_feb) AS compromiso_feb,
sum(a.causado_feb) AS causado_feb,
sum(a.pagado_feb) AS pagado_feb,
sum(a.compromiso_mar) AS compromiso_mar,
sum(a.causado_mar) AS causado_mar,
sum(a.pagado_mar) AS pagado_mar,
sum(a.compromiso_abr) AS compromiso_abr,
sum(a.causado_abr) AS causado_abr,
sum(a.pagado_abr) AS pagado_abr,
sum(a.compromiso_may) AS compromiso_may,
sum(a.causado_may) AS causado_may,
sum(a.pagado_may) AS pagado_may,
sum(a.compromiso_jun) AS compromiso_jun,
sum(a.causado_jun) AS causado_jun,
sum(a.pagado_jun) AS pagado_jun,
sum(a.compromiso_jul) AS compromiso_jul,
sum(a.causado_jul) AS causado_jul,
sum(a.pagado_jul) AS pagado_jul,
sum(a.compromiso_ago) AS compromiso_ago,
sum(a.causado_ago) AS causado_ago,
sum(a.pagado_ago) AS pagado_ago,
sum(a.compromiso_sep) AS compromiso_sep,
sum(a.causado_sep) AS causado_sep,
sum(a.pagado_sep) AS pagado_sep,
sum(a.compromiso_oct) AS compromiso_oct,
sum(a.causado_oct) AS causado_oct,
sum(a.pagado_oct) AS pagado_oct,
sum(a.compromiso_nov) AS compromiso_nov,
sum(a.causado_nov) AS causado_nov,
sum(a.pagado_nov) AS pagado_nov,
sum(a.compromiso_dic) AS compromiso_dic,
sum(a.causado_dic) AS causado_dic,
sum(a.pagado_dic) AS pagado_dic,
sum(a.deuda_ene) AS deuda_ene,
sum(a.deuda_feb) AS deuda_feb,
sum(a.deuda_mar) AS deuda_mar,
sum(a.deuda_abr) AS deuda_abr,
sum(a.deuda_may) AS deuda_may,
sum(a.deuda_jun) AS deuda_jun,
sum(a.deuda_jul) AS deuda_jul,
sum(a.deuda_ago) AS deuda_ago,
sum(a.deuda_sep) AS deuda_sep,
sum(a.deuda_oct) AS deuda_oct,
sum(a.deuda_nov) AS deuda_nov,
sum(a.deuda_dic) AS deuda_dic,
sum(a.enerom) AS enerom,
sum(a.febrerom) AS febrerom,
sum(a.marzom) AS marzom,
sum(a.abrilm) AS abrilm,
sum(a.mayom) AS mayom,
sum(a.juniom) AS juniom,
sum(a.juliom) AS juliom,
sum(a.agostom) AS agostom,
sum(a.septiembrem) AS septiembrem,
sum(a.octubrem) AS octubrem,
sum(a.noviembrem) AS noviembrem,
sum(a.diciembrem) AS diciembrem,
a.tipo_presupuesto
   FROM v_balance_ejecucion2 a
  GROUP BY a.cod_presi,
a.cod_entidad,
a.cod_tipo_inst,
a.cod_inst,
a.ano,
a.cod_sector,
a.deno_sector,
a.cod_programa,
a.deno_programa,
a.cod_sub_prog,
a.deno_sub_prog,
a.cod_proyecto,
a.deno_proyecto,
a.cod_activ_obra,
a.deno_activ_obra,
a.cod_partida,
a.cod_generica,
a.cod_especifica,
a.cod_sub_espec,
a.deno_sub_espec,
a.cod_auxiliar,
a.deno_auxiliar,
a.tipo_presupuesto;

ALTER TABLE v_balance_ejecucion2_inst OWNER TO sisap;



CREATE OR REPLACE VIEW v_f6_gr_bcv AS 
 SELECT a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_partida, a.cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, ((((substr(a.cod_partida::text, 1, 1) || '.'::text) || substr(a.cod_partida::text, 2, 2)) || '.'::text) || mascara_cero(a.cod_generica)) || '.00.00'::text AS campo_excel, sum(a.compromiso_ene + a.compromiso_feb + a.compromiso_mar) AS primer_trimestre, sum(a.compromiso_abr + a.compromiso_may + a.compromiso_jun) AS segundo_trimestre, sum(a.compromiso_jul + a.compromiso_ago + a.compromiso_sep) AS tercer_trimestre, sum(a.compromiso_oct + a.compromiso_nov + a.compromiso_dic) AS cuarto_trimestre
   FROM v_balance_ejecucion2 a
  WHERE a.cod_partida = ANY (ARRAY[401, 402, 403, 404])
  GROUP BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_partida, a.cod_generica
  ORDER BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_partida, a.cod_generica;

ALTER TABLE v_f6_gr_bcv OWNER TO sisap;



-- View: v_f3_gr_bcv

-- DROP VIEW v_f3_gr_bcv;

CREATE OR REPLACE VIEW v_f3_gr_bcv AS 
 SELECT a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, (((((((substr(a.cod_partida::text, 1, 1) || '.'::text) || substr(a.cod_partida::text, 2, 2)) || '.'::text) || mascara_cero(a.cod_generica)) || '.'::text) || mascara_cero(a.cod_especifica)) || '.'::text) || mascara_cero(a.cod_sub_espec) AS codigo_completo, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 1)) AS ejecutado_sector_01, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 2)) AS ejecutado_sector_02, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 3)) AS ejecutado_sector_03, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 4)) AS ejecutado_sector_04, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 5)) AS ejecutado_sector_05, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 6)) AS ejecutado_sector_06, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 7)) AS ejecutado_sector_07, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 8)) AS ejecutado_sector_08, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 9)) AS ejecutado_sector_09, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 10)) AS ejecutado_sector_10, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 11)) AS ejecutado_sector_11, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 12)) AS ejecutado_sector_12, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 13)) AS ejecutado_sector_13, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 14)) AS ejecutado_sector_14, null_cero(( SELECT sum(x.compromiso_ene + x.compromiso_feb + x.compromiso_mar + x.compromiso_abr + x.compromiso_may + x.compromiso_jun + x.compromiso_jul + x.compromiso_ago + x.compromiso_sep + x.compromiso_oct + x.compromiso_nov + x.compromiso_dic) AS sum
           FROM v_balance_ejecucion2 x
          WHERE x.cod_presi = a.cod_presi AND x.cod_entidad = a.cod_entidad AND x.cod_tipo_inst = a.cod_tipo_inst AND x.ano = a.ano AND x.cod_partida = a.cod_partida AND x.cod_generica = a.cod_generica AND x.cod_especifica = a.cod_especifica AND x.cod_sub_espec = a.cod_sub_espec AND x.cod_sector = 15)) AS ejecutado_sector_15
   FROM v_balance_ejecucion2 a
  GROUP BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec
  ORDER BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec;

ALTER TABLE v_f3_gr_bcv OWNER TO sisap;


-- View: v_proyeccion_gasto_dep

-- DROP VIEW v_proyeccion_gasto_dep;

CREATE OR REPLACE VIEW v_proyeccion_gasto_dep AS 
((((((((( SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, 0 AS cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 1 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector,v_balance_ejecucion2.tipo_presupuesto
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, 0 AS cod_sub_prog, 0 AS cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 2 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, 0 AS cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 3 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 4 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 5 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 6 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 7 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 8 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 9 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, 0 AS cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 10 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, 0 AS cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 11 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.cod_dep, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto;

ALTER TABLE v_proyeccion_gasto_dep OWNER TO sisap;


-- View: v_proyeccion_gasto_inst

-- DROP VIEW v_proyeccion_gasto_inst;

CREATE OR REPLACE VIEW v_proyeccion_gasto_inst AS 
((((((((( SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, 0 AS cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 1 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector,v_balance_ejecucion2.tipo_presupuesto
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, 0 AS cod_sub_prog, 0 AS cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 2 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, 0 AS cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 3 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 4 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 5 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 6 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 7 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_programa, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 8 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 9 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_sector, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, 0 AS cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, 0 AS cod_generica, 0 AS cod_especifica, 0 AS cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 10 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_partida,v_balance_ejecucion2.tipo_presupuesto)
UNION 
 SELECT v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, 0 AS cod_sector, 0 AS cod_programa, 0 AS cod_sub_prog, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec, sum(v_balance_ejecucion2.asignacion_anual) AS asignacion_anual, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric)::numeric(22,2)) AS dm_ene, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric)::numeric(22,2)) AS dm_feb, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric)::numeric(22,2)) AS dm_mar, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric)::numeric(22,2)) AS dm_abr, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric)::numeric(22,2)) AS dm_may, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric)::numeric(22,2)) AS dm_jun, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric)::numeric(22,2)) AS dm_jul, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric)::numeric(22,2)) AS dm_ago, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric)::numeric(22,2)) AS dm_sep, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric)::numeric(22,2)) AS dm_oct, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric)::numeric(22,2)) AS dm_nov, sum((v_balance_ejecucion2.asignacion_anual / 12::numeric + (v_balance_ejecucion2.aumento_ene - v_balance_ejecucion2.disminucion_ene) / 12::numeric + (v_balance_ejecucion2.aumento_feb - v_balance_ejecucion2.disminucion_feb) / 11::numeric + (v_balance_ejecucion2.aumento_mar - v_balance_ejecucion2.disminucion_mar) / 10::numeric + (v_balance_ejecucion2.aumento_abr - v_balance_ejecucion2.disminucion_abr) / 9::numeric + (v_balance_ejecucion2.aumento_may - v_balance_ejecucion2.disminucion_may) / 8::numeric + (v_balance_ejecucion2.aumento_jun - v_balance_ejecucion2.disminucion_jun) / 7::numeric + (v_balance_ejecucion2.aumento_jul - v_balance_ejecucion2.disminucion_jul) / 6::numeric + (v_balance_ejecucion2.aumento_ago - v_balance_ejecucion2.disminucion_ago) / 5::numeric + (v_balance_ejecucion2.aumento_sep - v_balance_ejecucion2.disminucion_sep) / 4::numeric + (v_balance_ejecucion2.aumento_oct - v_balance_ejecucion2.disminucion_oct) / 3::numeric + (v_balance_ejecucion2.aumento_nov - v_balance_ejecucion2.disminucion_nov) / 2::numeric + (v_balance_ejecucion2.aumento_dic - v_balance_ejecucion2.disminucion_dic) / 1::numeric)::numeric(22,2)) AS dm_dic, sum(v_balance_ejecucion2.compromiso_ene) AS compromiso_ene, sum(v_balance_ejecucion2.compromiso_feb) AS compromiso_feb, sum(v_balance_ejecucion2.compromiso_mar) AS compromiso_mar, sum(v_balance_ejecucion2.compromiso_abr) AS compromiso_abr, sum(v_balance_ejecucion2.compromiso_may) AS compromiso_may, sum(v_balance_ejecucion2.compromiso_jun) AS compromiso_jun, sum(v_balance_ejecucion2.compromiso_jul) AS compromiso_jul, sum(v_balance_ejecucion2.compromiso_ago) AS compromiso_ago, sum(v_balance_ejecucion2.compromiso_sep) AS compromiso_sep, sum(v_balance_ejecucion2.compromiso_oct) AS compromiso_oct, sum(v_balance_ejecucion2.compromiso_nov) AS compromiso_nov, sum(v_balance_ejecucion2.compromiso_dic) AS compromiso_dic, 11 AS modelo_reporte,v_balance_ejecucion2.tipo_presupuesto
   FROM v_balance_ejecucion2
  GROUP BY v_balance_ejecucion2.cod_presi, v_balance_ejecucion2.cod_entidad, v_balance_ejecucion2.cod_tipo_inst, v_balance_ejecucion2.cod_inst, v_balance_ejecucion2.ano, v_balance_ejecucion2.cod_partida, v_balance_ejecucion2.cod_generica, v_balance_ejecucion2.cod_especifica, v_balance_ejecucion2.cod_sub_espec,v_balance_ejecucion2.tipo_presupuesto;

ALTER TABLE v_proyeccion_gasto_inst OWNER TO sisap;



