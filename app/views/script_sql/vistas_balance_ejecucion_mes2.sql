CREATE OR REPLACE FUNCTION concepto_4letras(text)
  RETURNS text AS
$BODY$
DECLARE
t text;
BEGIN
IF $1 = 'ANUL' or $1 = 'DISM' or $1 = 'REIN' THEN
t = 'N';
elsif $1 = 'AUME' or $1 = 'CONT' or $1 = 'NOTA' or $1 = 'ORDE' or $1 = 'REGI' or $1 = 'REND'  or $1 = 'CANC' THEN
t = 'P';
end if;

RETURN t;
END;
$BODY$
  LANGUAGE 'plpgsql' VOLATILE
  COST 100;
ALTER FUNCTION concepto_4letras(text) OWNER TO sisap;

CREATE OR REPLACE VIEW balance_cfpd21 AS
 SELECT a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, sum(a.monto) AS monto, substr(a.fecha::text, 6, 2) AS mes, concepto_4letras(substr(upper(a.concepto), 0, 5)) AS concepto
   FROM cfpd21 a
  GROUP BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, substr(a.fecha::text, 6, 2), concepto_4letras(substr(upper(a.concepto), 0, 5))
  ORDER BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, substr(a.fecha::text, 6, 2), concepto_4letras(substr(upper(a.concepto), 0, 5));

ALTER TABLE balance_cfpd21 OWNER TO sisap;


CREATE OR REPLACE VIEW balance_cfpd22 AS
 SELECT a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, sum(a.monto) AS monto, substr(a.fecha::text, 6, 2) AS mes, concepto_4letras(substr(upper(a.concepto), 0, 5)) AS concepto
   FROM cfpd22 a
  GROUP BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, substr(a.fecha::text, 6, 2), concepto_4letras(substr(upper(a.concepto), 0, 5))
  ORDER BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, substr(a.fecha::text, 6, 2), concepto_4letras(substr(upper(a.concepto), 0, 5));

ALTER TABLE balance_cfpd22 OWNER TO sisap;


-- View: balance_cfpd23

-- DROP VIEW balance_cfpd23;

CREATE OR REPLACE VIEW balance_cfpd23 AS
 SELECT a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, sum(a.monto) AS monto, substr(a.fecha::text, 6, 2) AS mes, concepto_4letras(substr(upper(a.concepto), 0, 5)) AS concepto
   FROM cfpd23 a
  GROUP BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, substr(a.fecha::text, 6, 2), concepto_4letras(substr(upper(a.concepto), 0, 5))
  ORDER BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, substr(a.fecha::text, 6, 2), concepto_4letras(substr(upper(a.concepto), 0, 5));

ALTER TABLE balance_cfpd23 OWNER TO sisap;


CREATE OR REPLACE FUNCTION monto_balance_fcpd21(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text)
  RETURNS numeric AS
$BODY$
DECLARE
   amonto  numeric(26,2) = 0;
   xmonto  numeric(26,2) = 0;
BEGIN
 xmonto=(SELECT monto FROM balance_cfpd21 WHERE cod_presi=$1 and
cod_entidad=$2 and
cod_tipo_inst=$3 and
cod_inst=$4 and
cod_dep=$5 and
ano=$6 and
cod_sector=$7 and
cod_programa=$8 and
cod_sub_prog=$9 and
cod_proyecto=$10 and
cod_activ_obra=$11 and
cod_partida=$12 and
cod_generica=$13 and
cod_especifica=$14 and
cod_sub_espec=$15 and
cod_auxiliar=$16 and
mes=$17 and
concepto=$18);

amonto = null_cero(xmonto);
RETURN amonto;
END;
$BODY$
  LANGUAGE 'plpgsql' VOLATILE
  COST 100;
ALTER FUNCTION monto_balance_fcpd21(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text) OWNER TO sisap;


CREATE OR REPLACE FUNCTION monto_balance_fcpd22(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text)
  RETURNS numeric AS
$BODY$
DECLARE
   amonto  numeric(26,2) = 0;
   xmonto  numeric(26,2) = 0;
BEGIN
 xmonto=(SELECT monto FROM balance_cfpd22 WHERE cod_presi=$1 and
cod_entidad=$2 and
cod_tipo_inst=$3 and
cod_inst=$4 and
cod_dep=$5 and
ano=$6 and
cod_sector=$7 and
cod_programa=$8 and
cod_sub_prog=$9 and
cod_proyecto=$10 and
cod_activ_obra=$11 and
cod_partida=$12 and
cod_generica=$13 and
cod_especifica=$14 and
cod_sub_espec=$15 and
cod_auxiliar=$16 and
mes=$17 and
concepto=$18);

amonto = null_cero(xmonto);
RETURN amonto;
END;
$BODY$
  LANGUAGE 'plpgsql' VOLATILE
  COST 100;
ALTER FUNCTION monto_balance_fcpd22(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text) OWNER TO sisap;



CREATE OR REPLACE FUNCTION monto_balance_fcpd22(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text)
  RETURNS numeric AS
$BODY$
DECLARE
   amonto  numeric(26,2) = 0;
   xmonto  numeric(26,2) = 0;
BEGIN
 xmonto=(SELECT monto FROM balance_cfpd22 WHERE cod_presi=$1 and
cod_entidad=$2 and
cod_tipo_inst=$3 and
cod_inst=$4 and
cod_dep=$5 and
ano=$6 and
cod_sector=$7 and
cod_programa=$8 and
cod_sub_prog=$9 and
cod_proyecto=$10 and
cod_activ_obra=$11 and
cod_partida=$12 and
cod_generica=$13 and
cod_especifica=$14 and
cod_sub_espec=$15 and
cod_auxiliar=$16 and
mes=$17 and
concepto=$18);

amonto = null_cero(xmonto);
RETURN amonto;
END;
$BODY$
  LANGUAGE 'plpgsql' VOLATILE
  COST 100;
ALTER FUNCTION monto_balance_fcpd22(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text) OWNER TO sisap;



CREATE OR REPLACE FUNCTION monto_balance_fcpd23(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text)
  RETURNS numeric AS
$BODY$
DECLARE
   amonto  numeric(26,2) = 0;
   xmonto  numeric(26,2) = 0;
BEGIN
 xmonto=(SELECT monto FROM balance_cfpd23 WHERE cod_presi=$1 and
cod_entidad=$2 and
cod_tipo_inst=$3 and
cod_inst=$4 and
cod_dep=$5 and
ano=$6 and
cod_sector=$7 and
cod_programa=$8 and
cod_sub_prog=$9 and
cod_proyecto=$10 and
cod_activ_obra=$11 and
cod_partida=$12 and
cod_generica=$13 and
cod_especifica=$14 and
cod_sub_espec=$15 and
cod_auxiliar=$16 and
mes=$17 and
concepto=$18);

amonto = null_cero(xmonto);
RETURN amonto;
END;
$BODY$
  LANGUAGE 'plpgsql' VOLATILE
  COST 100;
ALTER FUNCTION monto_balance_fcpd23(integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, integer, text, text) OWNER TO sisap;



CREATE OR REPLACE VIEW v_balance_ejecucion2_2 AS
 SELECT a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, upper(( SELECT a1.denominacion
           FROM cfpd02_sector a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector)) AS deno_sector, a.cod_programa, upper(( SELECT a1.denominacion
           FROM cfpd02_programa a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa)) AS deno_programa, a.cod_sub_prog, upper(( SELECT a1.denominacion
           FROM cfpd02_sub_prog a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog)) AS deno_sub_prog, a.cod_proyecto, upper(( SELECT a1.denominacion
           FROM cfpd02_proyecto a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog AND a1.cod_proyecto = a.cod_proyecto)) AS deno_proyecto, a.cod_activ_obra, upper(( SELECT a1.denominacion
           FROM cfpd02_activ_obra a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog AND a1.cod_proyecto = a.cod_proyecto AND a1.cod_activ_obra = a.cod_activ_obra)) AS deno_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, upper(( SELECT a1.denominacion
           FROM cfpd01_ano_5_sub_espec a1
          WHERE a1.ejercicio = a.ano AND a1.cod_grupo = 4 AND a1.cod_partida = substr(a.cod_partida::text, 2, 2)::integer AND a1.cod_generica = a.cod_generica AND a1.cod_especifica = a.cod_especifica AND a1.cod_sub_espec = a.cod_sub_espec)) AS deno_sub_espec, a.cod_auxiliar, upper(( SELECT a1.denominacion
           FROM cfpd05_auxiliar a1
          WHERE a1.cod_presi = a.cod_presi AND a1.cod_entidad = a.cod_entidad AND a1.cod_tipo_inst = a.cod_tipo_inst AND a1.cod_inst = a.cod_inst AND a1.cod_dep = a.cod_dep AND a1.ano = a.ano AND a1.cod_sector = a.cod_sector AND a1.cod_programa = a.cod_programa AND a1.cod_sub_prog = a.cod_sub_prog AND a1.cod_proyecto = a.cod_proyecto AND a1.cod_activ_obra = a.cod_activ_obra AND a1.cod_partida = a.cod_partida AND a1.cod_generica = a.cod_generica AND a1.cod_especifica = a.cod_especifica AND a1.cod_sub_espec = a.cod_sub_espec AND a1.cod_auxiliar = a.cod_auxiliar)) AS deno_auxiliar, a.asignacion_anual, (a.aumento_traslado_ene + a.credito_adicional_ene)::numeric(22,2) AS aumento_ene, (a.aumento_traslado_feb + a.credito_adicional_feb)::numeric(22,2) AS aumento_feb, (a.aumento_traslado_mar + a.credito_adicional_mar)::numeric(22,2) AS aumento_mar, (a.aumento_traslado_abr + a.credito_adicional_abr)::numeric(22,2) AS aumento_abr, (a.aumento_traslado_may + a.credito_adicional_may)::numeric(22,2) AS aumento_may, (a.aumento_traslado_jun + a.credito_adicional_jun)::numeric(22,2) AS aumento_jun, (a.aumento_traslado_jul + a.credito_adicional_jul)::numeric(22,2) AS aumento_jul, (a.aumento_traslado_ago + a.credito_adicional_ago)::numeric(22,2) AS aumento_ago, (a.aumento_traslado_sep + a.credito_adicional_sep)::numeric(22,2) AS aumento_sep, (a.aumento_traslado_oct + a.credito_adicional_oct)::numeric(22,2) AS aumento_oct, (a.aumento_traslado_nov + a.credito_adicional_nov)::numeric(22,2) AS aumento_nov, (a.aumento_traslado_dic + a.credito_adicional_dic)::numeric(22,2) AS aumento_dic, (a.disminucion_traslado_ene + a.rebaja_ene)::numeric(22,2) AS disminucion_ene, (a.disminucion_traslado_feb + a.rebaja_feb)::numeric(22,2) AS disminucion_feb, (a.disminucion_traslado_mar + a.rebaja_mar)::numeric(22,2) AS disminucion_mar, (a.disminucion_traslado_abr + a.rebaja_abr)::numeric(22,2) AS disminucion_abr, (a.disminucion_traslado_may + a.rebaja_may)::numeric(22,2) AS disminucion_may, (a.disminucion_traslado_jun + a.rebaja_jun)::numeric(22,2) AS disminucion_jun, (a.disminucion_traslado_jul + a.rebaja_jul)::numeric(22,2) AS disminucion_jul, (a.disminucion_traslado_ago + a.rebaja_ago)::numeric(22,2) AS disminucion_ago, (a.disminucion_traslado_sep + a.rebaja_sep)::numeric(22,2) AS disminucion_sep, (a.disminucion_traslado_oct + a.rebaja_oct)::numeric(22,2) AS disminucion_oct, (a.disminucion_traslado_nov + a.rebaja_nov)::numeric(22,2) AS disminucion_nov, (a.disminucion_traslado_dic + a.rebaja_dic)::numeric(22,2) AS disminucion_dic, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '01'::text, 'P'::text) AS xcompromiso_ene, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '01'::text, 'N'::text) AS xcompromiso_ene_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '02'::text, 'P'::text) AS xcompromiso_feb, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '02'::text, 'N'::text) AS xcompromiso_feb_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '03'::text, 'P'::text) AS xcompromiso_mar, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '03'::text, 'N'::text) AS xcompromiso_mar_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '04'::text, 'P'::text) AS xcompromiso_abr, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '04'::text, 'N'::text) AS xcompromiso_abr_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '05'::text, 'P'::text) AS xcompromiso_may, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '05'::text, 'N'::text) AS xcompromiso_may_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '06'::text, 'P'::text) AS xcompromiso_jun, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '06'::text, 'N'::text) AS xcompromiso_jun_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '07'::text, 'P'::text) AS xcompromiso_jul, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '07'::text, 'N'::text) AS xcompromiso_jul_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '08'::text, 'P'::text) AS xcompromiso_ago, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '08'::text, 'N'::text) AS xcompromiso_ago_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '09'::text, 'P'::text) AS xcompromiso_sep, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '09'::text, 'N'::text) AS xcompromiso_sep_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '10'::text, 'P'::text) AS xcompromiso_oct, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '10'::text, 'N'::text) AS xcompromiso_oct_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '11'::text, 'P'::text) AS xcompromiso_nov, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '11'::text, 'N'::text) AS xcompromiso_nov_neg, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '12'::text, 'P'::text) AS xcompromiso_dic, monto_balance_fcpd21(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '12'::text, 'N'::text) AS xcompromiso_dic_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '01'::text, 'P'::text) AS xcausado_ene, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '01'::text, 'N'::text) AS xcausado_ene_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '02'::text, 'P'::text) AS xcausado_feb, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '02'::text, 'N'::text) AS xcausado_feb_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '03'::text, 'P'::text) AS xcausado_mar, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '03'::text, 'N'::text) AS xcausado_mar_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '04'::text, 'P'::text) AS xcausado_abr, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '04'::text, 'N'::text) AS xcausado_abr_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '05'::text, 'P'::text) AS xcausado_may, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '05'::text, 'N'::text) AS xcausado_may_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '06'::text, 'P'::text) AS xcausado_jun, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '06'::text, 'N'::text) AS xcausado_jun_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '07'::text, 'P'::text) AS xcausado_jul, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '07'::text, 'N'::text) AS xcausado_jul_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '08'::text, 'P'::text) AS xcausado_ago, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '08'::text, 'N'::text) AS xcausado_ago_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '09'::text, 'P'::text) AS xcausado_sep, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '09'::text, 'N'::text) AS xcausado_sep_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '10'::text, 'P'::text) AS xcausado_oct, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '10'::text, 'N'::text) AS xcausado_oct_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '11'::text, 'P'::text) AS xcausado_nov, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '11'::text, 'N'::text) AS xcausado_nov_neg, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '12'::text, 'P'::text) AS xcausado_dic, monto_balance_fcpd22(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '12'::text, 'N'::text) AS xcausado_dic_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '01'::text, 'P'::text) AS xpagado_ene, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '01'::text, 'N'::text) AS xpagado_ene_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '02'::text, 'P'::text) AS xpagado_feb, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '02'::text, 'N'::text) AS xpagado_feb_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '03'::text, 'P'::text) AS xpagado_mar, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '03'::text, 'N'::text) AS xpagado_mar_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '04'::text, 'P'::text) AS xpagado_abr, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '04'::text, 'N'::text) AS xpagado_abr_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '05'::text, 'P'::text) AS xpagado_may, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '05'::text, 'N'::text) AS xpagado_may_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '06'::text, 'P'::text) AS xpagado_jun, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '06'::text, 'N'::text) AS xpagado_jun_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '07'::text, 'P'::text) AS xpagado_jul, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '07'::text, 'N'::text) AS xpagado_jul_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '08'::text, 'P'::text) AS xpagado_ago, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '08'::text, 'N'::text) AS xpagado_ago_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '09'::text, 'P'::text) AS xpagado_sep, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '09'::text, 'N'::text) AS xpagado_sep_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '10'::text, 'P'::text) AS xpagado_oct, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '10'::text, 'N'::text) AS xpagado_oct_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '11'::text, 'P'::text) AS xpagado_nov, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '11'::text, 'N'::text) AS xpagado_nov_neg, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '12'::text, 'P'::text) AS xpagado_dic, monto_balance_fcpd23(a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.cod_dep, a.ano, a.cod_sector, a.cod_programa, a.cod_sub_prog, a.cod_proyecto, a.cod_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.cod_auxiliar, '12'::text, 'N'::text) AS xpagado_dic_neg, a.asignacion_anual AS enerom, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene))::numeric(22,2) AS febrerom, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb))::numeric(22,2) AS marzom, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar))::numeric(22,2) AS abrilm, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr))::numeric(22,2) AS mayom, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may))::numeric(22,2) AS juniom, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun))::numeric(22,2) AS juliom, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul))::numeric(22,2) AS agostom, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago))::numeric(22,2) AS septiembrem, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago + a.aumento_traslado_sep + a.credito_adicional_sep - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago + a.disminucion_traslado_sep + a.rebaja_sep + a.compromiso_sep))::numeric(22,2) AS octubrem, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago + a.aumento_traslado_sep + a.credito_adicional_sep + a.aumento_traslado_oct + a.credito_adicional_oct - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago + a.disminucion_traslado_sep + a.rebaja_sep + a.compromiso_sep + a.disminucion_traslado_oct + a.rebaja_oct + a.compromiso_oct))::numeric(22,2) AS noviembrem, (a.asignacion_anual + a.aumento_traslado_ene + a.credito_adicional_ene + a.aumento_traslado_feb + a.credito_adicional_feb + a.aumento_traslado_mar + a.credito_adicional_mar + a.aumento_traslado_abr + a.credito_adicional_abr + a.aumento_traslado_may + a.credito_adicional_may + a.aumento_traslado_jun + a.credito_adicional_jun + a.aumento_traslado_jul + a.credito_adicional_jul + a.aumento_traslado_ago + a.credito_adicional_ago + a.aumento_traslado_sep + a.credito_adicional_sep + a.aumento_traslado_oct + a.credito_adicional_oct + a.aumento_traslado_nov + a.credito_adicional_nov - (a.disminucion_traslado_ene + a.rebaja_ene + a.compromiso_ene + a.disminucion_traslado_feb + a.rebaja_feb + a.compromiso_feb + a.disminucion_traslado_mar + a.rebaja_mar + a.compromiso_mar + a.disminucion_traslado_abr + a.rebaja_abr + a.compromiso_abr + a.disminucion_traslado_may + a.rebaja_may + a.compromiso_may + a.disminucion_traslado_jun + a.rebaja_jun + a.compromiso_jun + a.disminucion_traslado_jul + a.rebaja_jul + a.compromiso_jul + a.disminucion_traslado_ago + a.rebaja_ago + a.compromiso_ago + a.disminucion_traslado_sep + a.rebaja_sep + a.compromiso_sep + a.disminucion_traslado_oct + a.rebaja_oct + a.compromiso_oct + a.disminucion_traslado_nov + a.rebaja_nov + a.compromiso_nov))::numeric(22,2) AS diciembrem
   FROM cfpd05 a;

ALTER TABLE v_balance_ejecucion2_2 OWNER TO sisap;


CREATE OR REPLACE VIEW v_balance_ejecucion22_inst AS
 SELECT a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_sector, a.deno_sector, a.cod_programa, a.deno_programa, a.cod_sub_prog, a.deno_sub_prog, a.cod_proyecto, a.deno_proyecto, a.cod_activ_obra, a.deno_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.deno_sub_espec, a.cod_auxiliar, a.deno_auxiliar, sum(a.asignacion_anual) AS asignacion_anual, sum(a.aumento_ene) AS aumento_ene, sum(a.aumento_feb) AS aumento_feb, sum(a.aumento_mar) AS aumento_mar, sum(a.aumento_abr) AS aumento_abr, sum(a.aumento_may) AS aumento_may, sum(a.aumento_jun) AS aumento_jun, sum(a.aumento_jul) AS aumento_jul, sum(a.aumento_ago) AS aumento_ago, sum(a.aumento_sep) AS aumento_sep, sum(a.aumento_oct) AS aumento_oct, sum(a.aumento_nov) AS aumento_nov, sum(a.aumento_dic) AS aumento_dic, sum(a.disminucion_ene) AS disminucion_ene, sum(a.disminucion_feb) AS disminucion_feb, sum(a.disminucion_mar) AS disminucion_mar, sum(a.disminucion_abr) AS disminucion_abr, sum(a.disminucion_may) AS disminucion_may, sum(a.disminucion_jun) AS disminucion_jun, sum(a.disminucion_jul) AS disminucion_jul, sum(a.disminucion_ago) AS disminucion_ago, sum(a.disminucion_sep) AS disminucion_sep, sum(a.disminucion_oct) AS disminucion_oct, sum(a.disminucion_nov) AS disminucion_nov, sum(a.disminucion_dic) AS disminucion_dic, sum(a.xcompromiso_ene) AS xcompromiso_ene, sum(a.xcompromiso_ene_neg) AS xcompromiso_ene_neg, sum(a.xcompromiso_feb) AS xcompromiso_feb, sum(a.xcompromiso_feb_neg) AS xcompromiso_feb_neg, sum(a.xcompromiso_mar) AS xcompromiso_mar, sum(a.xcompromiso_mar_neg) AS xcompromiso_mar_neg, sum(a.xcompromiso_abr) AS xcompromiso_abr, sum(a.xcompromiso_abr_neg) AS xcompromiso_abr_neg, sum(a.xcompromiso_may) AS xcompromiso_may, sum(a.xcompromiso_may_neg) AS xcompromiso_may_neg, sum(a.xcompromiso_jun) AS xcompromiso_jun, sum(a.xcompromiso_jun_neg) AS xcompromiso_jun_neg, sum(a.xcompromiso_jul) AS xcompromiso_jul, sum(a.xcompromiso_jul_neg) AS xcompromiso_jul_neg, sum(a.xcompromiso_ago) AS xcompromiso_ago, sum(a.xcompromiso_ago_neg) AS xcompromiso_ago_neg, sum(a.xcompromiso_sep) AS xcompromiso_sep, sum(a.xcompromiso_sep_neg) AS xcompromiso_sep_neg, sum(a.xcompromiso_oct) AS xcompromiso_oct, sum(a.xcompromiso_oct_neg) AS xcompromiso_oct_neg, sum(a.xcompromiso_nov) AS xcompromiso_nov, sum(a.xcompromiso_nov_neg) AS xcompromiso_nov_neg, sum(a.xcompromiso_dic) AS xcompromiso_dic, sum(a.xcompromiso_dic_neg) AS xcompromiso_dic_neg, sum(a.xcausado_ene) AS xcausado_ene, sum(a.xcausado_ene_neg) AS xcausado_ene_neg, sum(a.xcausado_feb) AS xcausado_feb, sum(a.xcausado_feb_neg) AS xcausado_feb_neg, sum(a.xcausado_mar) AS xcausado_mar, sum(a.xcausado_mar_neg) AS xcausado_mar_neg, sum(a.xcausado_abr) AS xcausado_abr, sum(a.xcausado_abr_neg) AS xcausado_abr_neg, sum(a.xcausado_may) AS xcausado_may, sum(a.xcausado_may_neg) AS xcausado_may_neg, sum(a.xcausado_jun) AS xcausado_jun, sum(a.xcausado_jun_neg) AS xcausado_jun_neg, sum(a.xcausado_jul) AS xcausado_jul, sum(a.xcausado_jul_neg) AS xcausado_jul_neg, sum(a.xcausado_ago) AS xcausado_ago, sum(a.xcausado_ago_neg) AS xcausado_ago_neg, sum(a.xcausado_sep) AS xcausado_sep, sum(a.xcausado_sep_neg) AS xcausado_sep_neg, sum(a.xcausado_oct) AS xcausado_oct, sum(a.xcausado_oct_neg) AS xcausado_oct_neg, sum(a.xcausado_nov) AS xcausado_nov, sum(a.xcausado_nov_neg) AS xcausado_nov_neg, sum(a.xcausado_dic) AS xcausado_dic, sum(a.xcausado_dic_neg) AS xcausado_dic_neg, sum(a.xpagado_ene) AS xpagado_ene, sum(a.xpagado_ene_neg) AS xpagado_ene_neg, sum(a.xpagado_feb) AS xpagado_feb, sum(a.xpagado_feb_neg) AS xpagado_feb_neg, sum(a.xpagado_mar) AS xpagado_mar, sum(a.xpagado_mar_neg) AS xpagado_mar_neg, sum(a.xpagado_abr) AS xpagado_abr, sum(a.xpagado_abr_neg) AS xpagado_abr_neg, sum(a.xpagado_may) AS xpagado_may, sum(a.xpagado_may_neg) AS xpagado_may_neg, sum(a.xpagado_jun) AS xpagado_jun, sum(a.xpagado_jun_neg) AS xpagado_jun_neg, sum(a.xpagado_jul) AS xpagado_jul, sum(a.xpagado_jul_neg) AS xpagado_jul_neg, sum(a.xpagado_ago) AS xpagado_ago, sum(a.xpagado_ago_neg) AS xpagado_ago_neg, sum(a.xpagado_sep) AS xpagado_sep, sum(a.xpagado_sep_neg) AS xpagado_sep_neg, sum(a.xpagado_oct) AS xpagado_oct, sum(a.xpagado_oct_neg) AS xpagado_oct_neg, sum(a.xpagado_nov) AS xpagado_nov, sum(a.xpagado_nov_neg) AS xpagado_nov_neg, sum(a.xpagado_dic) AS xpagado_dic, sum(a.xpagado_dic_neg) AS xpagado_dic_neg, sum(a.enerom) AS enerom, sum(a.febrerom) AS febrerom, sum(a.marzom) AS marzom, sum(a.abrilm) AS abrilm, sum(a.mayom) AS mayom, sum(a.juniom) AS juniom, sum(a.juliom) AS juliom, sum(a.agostom) AS agostom, sum(a.septiembrem) AS septiembrem, sum(a.octubrem) AS octubrem, sum(a.noviembrem) AS noviembrem, sum(a.diciembrem) AS diciembrem
   FROM v_balance_ejecucion2_2 a
  GROUP BY a.cod_presi, a.cod_entidad, a.cod_tipo_inst, a.cod_inst, a.ano, a.cod_sector, a.deno_sector, a.cod_programa, a.deno_programa, a.cod_sub_prog, a.deno_sub_prog, a.cod_proyecto, a.deno_proyecto, a.cod_activ_obra, a.deno_activ_obra, a.cod_partida, a.cod_generica, a.cod_especifica, a.cod_sub_espec, a.deno_sub_espec, a.cod_auxiliar, a.deno_auxiliar;

ALTER TABLE v_balance_ejecucion22_inst OWNER TO sisap;
